<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using plyranges to perform common genomic data wrangling tasks • plyranges</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">plyranges</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/an-introduction.html">Getting started with the plyranges package</a>
    </li>
    <li>
      <a href="../articles/comparision.html">Using plyranges to perform common genomic data wrangling tasks</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Using plyranges to perform common genomic data wrangling tasks</h1>
                        <h4 class="author">Stuart Lee</h4>
            
            <h4 class="date">2018-01-10</h4>
          </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      A fluent interface to <code>Ranges</code> classes.
    </div>
    
<div class="contents">
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Here we introduce the <code>plyranges</code> API for manipulating genomic data. The examples follow the <a href="http://bioconductor.org/packages/release/bioc/vignettes/HelloRanges/inst/doc/tutorial.pdf">HelloRanges tutorial</a>. The aim is to show how common analysis tasks that are usually undertaken using <code>bedtools</code> can be performed interactively using the <code>plyranges</code> API. Throughout this tutorial we will highlight how the <code>bedtools</code>, <code>HelloRanges</code> and <code>plyranges</code> API differ.</p>
<p>The <code>plyranges</code> API attempts to be type-consistent, that is if you apply a <code>plyranges</code> function to a <em>Ranges</em> object it should return a <em>Ranges</em> object. This means that intermittant Bioconductor classes such as <code>Rle</code> objects are hidden away from the user, and the user can focus on the table-like structure of ordinary <em>Ranges</em> objects. A <em>Ranges</em> object, in particular a <em>GRanges</em> object resembles a BED file and has columns to represent the chromomsome, start, end, and strand information. It can also contain additional columns called metadata containing information about the rows (i.e an exon name or a measurement).</p>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<p>The data we use for these examples are exported by the <code>HelloRangesData</code> package. For more details see that <a href="http://bioconductor.org/packages/release/data/experiment/vignettes/HelloRangesData/inst/doc/intro.pdf">package’s vignette</a>. For most examples in this tutorial we will use the RefSeq exons and CpG island annotations from the hg19 genome build.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exons_bed &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"exons.bed"</span>, <span class="dt">package=</span><span class="st">"HelloRangesData"</span>)
cpg_bed &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"cpg.bed"</span>, <span class="dt">package =</span> <span class="st">"HelloRangesData"</span>)</code></pre></div>
</div>
<div id="reading-bed-files" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-bed-files" class="anchor"></a>Reading BED files</h1>
<p>To load the exons file as a <em>GRanges</em> object we use the <code>read_bed</code> function. We supply the genome build as an additional argument to this function, allowing us to obtain annotation information about each chromosome.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(plyranges))
cpg &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bed-files-read.html">read_bed</a></span>(cpg_bed, <span class="dt">genome_info =</span> <span class="st">"hg19"</span>)
cpg</code></pre></div>
<pre><code>## GRanges object with 28691 ranges and 1 metadata column:
##           seqnames               ranges strand |        name
##              &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;
##       [1]     chr1     [ 28736,  29810]      * |    CpG:_116
##       [2]     chr1     [135125, 135563]      * |     CpG:_30
##       [3]     chr1     [327791, 328229]      * |     CpG:_29
##       [4]     chr1     [437152, 438164]      * |     CpG:_84
##       [5]     chr1     [449274, 450544]      * |     CpG:_99
##       ...      ...                  ...    ... .         ...
##   [28687]     chrY [27610116, 27611088]      * |     CpG:_76
##   [28688]     chrY [28555536, 28555932]      * |     CpG:_32
##   [28689]     chrY [28773316, 28773544]      * |     CpG:_25
##   [28690]     chrY [59213795, 59214183]      * |     CpG:_36
##   [28691]     chrY [59349267, 59349574]      * |     CpG:_29
##   -------
##   seqinfo: 93 sequences from hg19 genome</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exons &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bed-files-read.html">read_bed</a></span>(exons_bed, <span class="dt">genome_info =</span> <span class="kw"><a href="../reference/ranges-info-get.html">get_genome_info</a></span>(cpg))
exons</code></pre></div>
<pre><code>## GRanges object with 459752 ranges and 2 metadata columns:
##            seqnames               ranges strand |
##               &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; |
##        [1]     chr1       [11874, 12227]      + |
##        [2]     chr1       [12613, 12721]      + |
##        [3]     chr1       [13221, 14409]      + |
##        [4]     chr1       [14362, 14829]      - |
##        [5]     chr1       [14970, 15038]      - |
##        ...      ...                  ...    ... .
##   [459748]     chrY [59338754, 59338859]      + |
##   [459749]     chrY [59338754, 59338859]      + |
##   [459750]     chrY [59340194, 59340278]      + |
##   [459751]     chrY [59342487, 59343488]      + |
##   [459752]     chrY [59342487, 59343488]      + |
##                                          name     score
##                                   &lt;character&gt; &lt;numeric&gt;
##        [1]    NR_046018_exon_0_0_chr1_11874_f         0
##        [2]    NR_046018_exon_1_0_chr1_12613_f         0
##        [3]    NR_046018_exon_2_0_chr1_13221_f         0
##        [4]    NR_024540_exon_0_0_chr1_14362_r         0
##        [5]    NR_024540_exon_1_0_chr1_14970_r         0
##        ...                                ...       ...
##   [459748] NM_002186_exon_6_0_chrY_59338754_f         0
##   [459749] NM_176786_exon_7_0_chrY_59338754_f         0
##   [459750] NM_002186_exon_7_0_chrY_59340194_f         0
##   [459751] NM_002186_exon_8_0_chrY_59342487_f         0
##   [459752] NM_176786_exon_8_0_chrY_59342487_f         0
##   -------
##   seqinfo: 93 sequences from hg19 genome</code></pre>
</div>
<div id="intersections-and-overlaps" class="section level1">
<h1 class="hasAnchor">
<a href="#intersections-and-overlaps" class="anchor"></a>Intersections and Overlaps</h1>
<p>A useful operation on two <em>Ranges</em> is to identify where they intersect. By default <code>bedtools</code> will return the region of intersection between two genomic tracks. In <code>plyranges</code> the intersect operation is a type of overlap join, that is we are finding the common genomic intervals that overlap between the two tracks.</p>
<p>In <code>plyranges</code> this is termed an intersect overlap join:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">intersect_rng &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlap-joins.html">join_overlap_intersect</a></span>(cpg, exons)
intersect_rng</code></pre></div>
<pre><code>## GRanges object with 45500 ranges and 3 metadata columns:
##           seqnames               ranges strand |      name.x
##              &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;
##       [1]     chr1     [ 29321,  29370]      * |    CpG:_116
##       [2]     chr1     [135125, 135563]      * |     CpG:_30
##       [3]     chr1     [327791, 328229]      * |     CpG:_29
##       [4]     chr1     [327791, 328229]      * |     CpG:_29
##       [5]     chr1     [327791, 328229]      * |     CpG:_29
##       ...      ...                  ...    ... .         ...
##   [45496]     chrY [59213949, 59214117]      * |     CpG:_36
##   [45497]     chrY [59213949, 59214117]      * |     CpG:_36
##   [45498]     chrY [59213949, 59214117]      * |     CpG:_36
##   [45499]     chrY [59213949, 59214117]      * |     CpG:_36
##   [45500]     chrY [59213949, 59214117]      * |     CpG:_36
##                                          name.y     score
##                                     &lt;character&gt; &lt;numeric&gt;
##       [1]      NR_024540_exon_10_0_chr1_29321_r         0
##       [2]      NR_039983_exon_0_0_chr1_134773_r         0
##       [3]      NR_028322_exon_2_0_chr1_324439_f         0
##       [4]      NR_028325_exon_2_0_chr1_324439_f         0
##       [5]      NR_028327_exon_3_0_chr1_327036_f         0
##       ...                                   ...       ...
##   [45496] NM_001145149_exon_0_0_chrY_59213949_f         0
##   [45497] NM_001185183_exon_0_0_chrY_59213949_f         0
##   [45498]    NM_005638_exon_0_0_chrY_59213949_f         0
##   [45499]    NR_033714_exon_0_0_chrY_59213949_f         0
##   [45500]    NR_033715_exon_0_0_chrY_59213949_f         0
##   -------
##   seqinfo: 93 sequences from hg19 genome</code></pre>
<p>In the <code>HelloRanges</code> API (we also see the <code>bedtools</code> code here) the equivalent operation is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(HelloRanges))
code &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/HelloRanges/topics/bedtools_intersect">bedtools_intersect</a></span>(<span class="st">"-a cpg.bed -b exons.bed -g hg19"</span>)
code</code></pre></div>
<pre><code>## {
##     genome &lt;- Seqinfo(genome = "hg19")
##     gr_a &lt;- import("cpg.bed", genome = genome)
##     gr_b &lt;- import("exons.bed", genome = genome)
##     pairs &lt;- findOverlapPairs(gr_a, gr_b, ignore.strand = TRUE)
##     ans &lt;- pintersect(pairs, ignore.strand = TRUE)
##     ans
## }</code></pre>
<div id="keeping-the-original-features" class="section level2">
<h2 class="hasAnchor">
<a href="#keeping-the-original-features" class="anchor"></a>Keeping the original features</h2>
<p>By default an overlap join will keep the information in both the query and subject ranges.</p>
</div>
<div id="computing-the-amount-of-overlap" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-the-amount-of-overlap" class="anchor"></a>Computing the amount of overlap</h2>
<p>To compute the amount of overlap we store the width of the intersecting ranges as an additional column using the <code>mutate</code> operator.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">intersect_rng &lt;-<span class="st"> </span>intersect_rng <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">overlap_width =</span> width)</code></pre></div>
<p>The equivalent bedtools/HelloRanges command is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/HelloRanges/topics/bedtools_intersect">bedtools_intersect</a></span>(<span class="st">"-a cpg.bed -b exons.bed -g hg19 -wo"</span>)</code></pre></div>
<pre><code>## {
##     genome &lt;- Seqinfo(genome = "hg19")
##     gr_a &lt;- import("cpg.bed", genome = genome)
##     gr_b &lt;- import("exons.bed", genome = genome)
##     pairs &lt;- findOverlapPairs(gr_a, gr_b, ignore.strand = TRUE)
##     ans &lt;- pairs
##     mcols(ans)$overlap_width &lt;- width(pintersect(ans, ignore.strand = TRUE))
##     ans
## }</code></pre>
</div>
<div id="counting-the-number-of-overlaps" class="section level2">
<h2 class="hasAnchor">
<a href="#counting-the-number-of-overlaps" class="anchor"></a>Counting the number of overlaps</h2>
<p>To add the count of the number of times each cpg island overlaps an exon we can use <code>mutate</code> with the <code>count_overlaps</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cpg <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">overlaps =</span> <span class="kw"><a href="../reference/ranges-count-overlaps.Rd.html">count_overlaps</a></span>(., exons))</code></pre></div>
<pre><code>## GRanges object with 28691 ranges and 2 metadata columns:
##           seqnames               ranges strand |        name  overlaps
##              &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;integer&gt;
##       [1]     chr1     [ 28736,  29810]      * |    CpG:_116         1
##       [2]     chr1     [135125, 135563]      * |     CpG:_30         1
##       [3]     chr1     [327791, 328229]      * |     CpG:_29         3
##       [4]     chr1     [437152, 438164]      * |     CpG:_84         0
##       [5]     chr1     [449274, 450544]      * |     CpG:_99         0
##       ...      ...                  ...    ... .         ...       ...
##   [28687]     chrY [27610116, 27611088]      * |     CpG:_76         0
##   [28688]     chrY [28555536, 28555932]      * |     CpG:_32         0
##   [28689]     chrY [28773316, 28773544]      * |     CpG:_25         0
##   [28690]     chrY [59213795, 59214183]      * |     CpG:_36         5
##   [28691]     chrY [59349267, 59349574]      * |     CpG:_29         0
##   -------
##   seqinfo: 93 sequences from hg19 genome</code></pre>
<p>The equivalent bedtools operation is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/HelloRanges/topics/bedtools_intersect">bedtools_intersect</a></span>(<span class="st">"-a cpg.bed -b exons.bed -g hg19 -c"</span>)</code></pre></div>
<pre><code>## {
##     genome &lt;- Seqinfo(genome = "hg19")
##     gr_a &lt;- import("cpg.bed", genome = genome)
##     gr_b &lt;- import("exons.bed", genome = genome)
##     ans &lt;- gr_a
##     mcols(ans)$overlap_count &lt;- countOverlaps(gr_a, gr_b, ignore.strand = TRUE)
##     ans
## }</code></pre>
</div>
<div id="excluding-by-overlaps" class="section level2">
<h2 class="hasAnchor">
<a href="#excluding-by-overlaps" class="anchor"></a>Excluding by overlaps</h2>
<p>We can use <code>filter_by_non_overlaps</code> to include CpG islands that do not overlap any exons.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cpg <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/filter-overlaps.rd.html">filter_by_non_overlaps</a></span>(., exons)</code></pre></div>
<pre><code>## GRanges object with 9846 ranges and 1 metadata column:
##          seqnames               ranges strand |        name
##             &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;
##      [1]     chr1     [437152, 438164]      * |     CpG:_84
##      [2]     chr1     [449274, 450544]      * |     CpG:_99
##      [3]     chr1     [533220, 534114]      * |     CpG:_94
##      [4]     chr1     [544739, 546649]      * |    CpG:_171
##      [5]     chr1     [801976, 802338]      * |     CpG:_24
##      ...      ...                  ...    ... .         ...
##   [9842]     chrY [26351344, 26352316]      * |     CpG:_76
##   [9843]     chrY [27610116, 27611088]      * |     CpG:_76
##   [9844]     chrY [28555536, 28555932]      * |     CpG:_32
##   [9845]     chrY [28773316, 28773544]      * |     CpG:_25
##   [9846]     chrY [59349267, 59349574]      * |     CpG:_29
##   -------
##   seqinfo: 93 sequences from hg19 genome</code></pre>
<p>The equivalent bedtools operation is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/HelloRanges/topics/bedtools_intersect">bedtools_intersect</a></span>(<span class="st">"-a cpg.bed -b exons.bed -g hg19 -v"</span>)</code></pre></div>
<pre><code>## {
##     genome &lt;- Seqinfo(genome = "hg19")
##     gr_a &lt;- import("cpg.bed", genome = genome)
##     gr_b &lt;- import("exons.bed", genome = genome)
##     subsetByOverlaps(gr_a, gr_b, invert = TRUE, ignore.strand = TRUE)
## }</code></pre>
</div>
</div>
<div id="computing-genomic-coverage" class="section level1">
<h1 class="hasAnchor">
<a href="#computing-genomic-coverage" class="anchor"></a>Computing Genomic Coverage</h1>
<p>Often we are interested in counting the number of features over an entire genome that overlap each other. In <code>plyranges</code> this is done with the <code>compute_coverage</code> function in combination with other functions to manipulate the results. This function will always return a new <em>Ranges</em> object with a column called score. Any other variables associated with the input <em>Ranges</em> will be dropped.</p>
<div id="coverage-vector" class="section level2">
<h2 class="hasAnchor">
<a href="#coverage-vector" class="anchor"></a>Coverage Vector</h2>
<p>By default, <code>compute_coverage</code> is equivalent to <code>bedtools genomecov -bga</code> and hence will return scores equal to zero. Filtering all scores above zero is equivalent to <code>bedtools genomecov -bg</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvg &lt;-<span class="st"> </span>exons <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/compute_coverage.html">compute_coverage</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(score <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
cvg</code></pre></div>
<pre><code>## GRanges object with 245860 ranges and 1 metadata column:
##                  seqnames           ranges strand |     score
##                     &lt;Rle&gt;        &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt;
##        [1]           chr1   [11874, 12227]      * |         1
##        [2]           chr1   [12613, 12721]      * |         1
##        [3]           chr1   [13221, 14361]      * |         1
##        [4]           chr1   [14362, 14409]      * |         2
##        [5]           chr1   [14410, 14829]      * |         1
##        ...            ...              ...    ... .       ...
##   [245856] chrUn_gl000228 [109202, 110581]      * |         6
##   [245857] chrUn_gl000228 [112508, 112604]      * |         6
##   [245858] chrUn_gl000228 [112605, 113887]      * |         7
##   [245859] chrUn_gl000228 [114024, 114115]      * |         1
##   [245860] chrUn_gl000228 [114478, 114676]      * |         1
##   -------
##   seqinfo: 93 sequences from an unspecified genome</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/HelloRanges/topics/bedtools_genomecov">bedtools_genomecov</a></span>(<span class="st">"-i exons.bed -g hg19.genome -bg"</span>)</code></pre></div>
<pre><code>## {
##     genome &lt;- import("hg19.genome")
##     gr_a &lt;- import("exons.bed", genome = genome)
##     cov &lt;- coverage(gr_a)
##     ans &lt;- GRanges(cov)
##     ans &lt;- subset(ans, score &gt; 0)
##     ans
## }</code></pre>
</div>
<div id="coverage-histogram" class="section level2">
<h2 class="hasAnchor">
<a href="#coverage-histogram" class="anchor"></a>Coverage histogram</h2>
<p>We can construct a histogram over all seqeunces in a genome using the <code>group_by</code> and <code>summarise</code> operations along with <code>left_join</code>.</p>
<p>First, we compute the coverage over the exons and construct a <code>DataFrame</code> from the genome build information using <code>select</code> with <code>.drop_ranges = FALSE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(dplyr))
cvg &lt;-<span class="st"> </span>exons <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/compute_coverage.html">compute_coverage</a></span>()
<span class="co"># convert the sequence annotation to a data.frame </span>
hg19 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ranges-info-get.html">get_genome_info</a></span>(cvg) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(seqnames, width, <span class="dt">.drop_ranges =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as.data.frame</span>()</code></pre></div>
<p>Then to count the number of bases corresponding to a score we sum over the width of each range in each chromosome. Then we join the resulting <code>tibble</code> to the annotation <code>tibble</code> called <code>hg19</code>. Note that in the sums we have coerced integer variables to doubles to avoid overflow.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvg_hist_by_seq &lt;-<span class="st"> </span>cvg <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(seqnames, score) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">count =</span> <span class="kw">sum</span>(<span class="kw">as.numeric</span>(width))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(., hg19) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">fraction =</span> count <span class="op">/</span><span class="st"> </span>width)</code></pre></div>
<pre><code>## Joining, by = "seqnames"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvg_hist_by_seq</code></pre></div>
<pre><code>##                  seqnames score     count     width     fraction
## 1                    chr1     0 241996316 249250621 9.708955e-01
## 2                    chr2     0 238060317 243199373 9.788690e-01
## 3                    chr3     0 193800642 198022430 9.786803e-01
## 4                    chr4     0 188206114 191154276 9.845771e-01
## 5                    chr5     0 177466741 180915260 9.809385e-01
## 6                    chr6     0 167349524 171115067 9.779941e-01
## 7                    chr7     0 155623839 159138663 9.779135e-01
## 8                    chr8     0 143743330 146364022 9.820947e-01
## 9                    chr9     0 138299162 141213431 9.793627e-01
## 10                  chr10     0 132497709 135534747 9.775922e-01
## 11                  chr11     0 131006080 135006516 9.703686e-01
## 12                  chr12     0 130064532 133851895 9.717048e-01
## 13                  chr13     0 113673678 115169878 9.870088e-01
## 14                  chr14     0 105123433 107349540 9.792630e-01
## 15                  chr15     0  99958995 102531392 9.749111e-01
## 16                  chr16     0  87607969  90354753 9.696000e-01
## 17                  chr17     0  77292857  81195210 9.519386e-01
## 18                  chr18     0  76820718  78077248 9.839066e-01
## 19                  chr19     0  55150438  59128983 9.327141e-01
## 20                  chr20     0  61266283  63025520 9.720869e-01
## 21                  chr21     0  47353297  48129895 9.838645e-01
## 22                  chr22     0  49705692  51304566 9.688356e-01
## 23                   chrX     0 152463860 155270560 9.819238e-01
## 24                   chrY     0  59123079  59373566 9.957812e-01
## 25                   chrM     0     16571     16571 1.000000e+00
## 26   chr1_gl000191_random     0    101442    106433 9.531066e-01
## 27   chr1_gl000192_random     0    538629    547496 9.838044e-01
## 28         chr4_ctg9_hap1     0    572880    590426 9.702825e-01
## 29   chr4_gl000193_random     0    188583    189789 9.936456e-01
## 30   chr4_gl000194_random     0    186132    191469 9.721260e-01
## 31          chr6_apd_hap1     0   4415526   4622290 9.552681e-01
## 32          chr6_cox_hap2     0   4359026   4795371 9.090070e-01
## 33          chr6_dbb_hap3     0   4209652   4610396 9.130782e-01
## 34         chr6_mann_hap4     0   4350272   4683263 9.288977e-01
## 35          chr6_mcf_hap5     0   4450961   4833398 9.208762e-01
## 36          chr6_qbl_hap6     0   4204044   4611984 9.115478e-01
## 37         chr6_ssto_hap7     0   4566593   4928567 9.265559e-01
## 38   chr7_gl000195_random     0    180483    182896 9.868067e-01
## 39   chr8_gl000196_random     0     38914     38914 1.000000e+00
## 40   chr8_gl000197_random     0     37175     37175 1.000000e+00
## 41   chr9_gl000198_random     0     90085     90085 1.000000e+00
## 42   chr9_gl000199_random     0    169874    169874 1.000000e+00
## 43   chr9_gl000200_random     0    187035    187035 1.000000e+00
## 44   chr9_gl000201_random     0     36148     36148 1.000000e+00
## 45  chr11_gl000202_random     0     40103     40103 1.000000e+00
## 46        chr17_ctg5_hap1     0   1603611   1680828 9.540601e-01
## 47  chr17_gl000203_random     0     37498     37498 1.000000e+00
## 48  chr17_gl000204_random     0     81310     81310 1.000000e+00
## 49  chr17_gl000205_random     0    171478    174588 9.821866e-01
## 50  chr17_gl000206_random     0     41001     41001 1.000000e+00
## 51  chr18_gl000207_random     0      4262      4262 1.000000e+00
## 52  chr19_gl000208_random     0     92689     92689 1.000000e+00
## 53  chr19_gl000209_random     0    148034    159169 9.300429e-01
## 54  chr21_gl000210_random     0     27682     27682 1.000000e+00
## 55         chrUn_gl000211     0    164045    166566 9.848649e-01
## 56         chrUn_gl000212     0    184896    186858 9.895000e-01
## 57         chrUn_gl000213     0    162413    164239 9.888821e-01
## 58         chrUn_gl000214     0    137718    137718 1.000000e+00
## 59         chrUn_gl000215     0    172545    172545 1.000000e+00
## 60         chrUn_gl000216     0    172294    172294 1.000000e+00
## 61         chrUn_gl000217     0    172149    172149 1.000000e+00
## 62         chrUn_gl000218     0    151322    161147 9.390308e-01
## 63         chrUn_gl000219     0    175536    179198 9.795645e-01
## 64         chrUn_gl000220     0    145344    161802 8.982831e-01
## 65         chrUn_gl000221     0    155397    155397 1.000000e+00
## 66         chrUn_gl000222     0    183259    186861 9.807236e-01
## 67         chrUn_gl000223     0    170137    180455 9.428223e-01
## 68         chrUn_gl000224     0    179693    179693 1.000000e+00
## 69         chrUn_gl000225     0    211173    211173 1.000000e+00
## 70         chrUn_gl000226     0     15008     15008 1.000000e+00
## 71         chrUn_gl000227     0    128374    128374 1.000000e+00
## 72         chrUn_gl000228     0    108805    129120 8.426657e-01
## 73         chrUn_gl000229     0     19913     19913 1.000000e+00
## 74         chrUn_gl000230     0     43691     43691 1.000000e+00
## 75         chrUn_gl000231     0     27386     27386 1.000000e+00
## 76         chrUn_gl000232     0     40652     40652 1.000000e+00
## 77         chrUn_gl000233     0     45941     45941 1.000000e+00
## 78         chrUn_gl000234     0     40531     40531 1.000000e+00
## 79         chrUn_gl000235     0     34474     34474 1.000000e+00
## 80         chrUn_gl000236     0     41934     41934 1.000000e+00
## 81         chrUn_gl000237     0     45867     45867 1.000000e+00
## 82         chrUn_gl000238     0     39939     39939 1.000000e+00
## 83         chrUn_gl000239     0     33824     33824 1.000000e+00
## 84         chrUn_gl000240     0     41933     41933 1.000000e+00
## 85         chrUn_gl000241     0     42152     42152 1.000000e+00
## 86         chrUn_gl000242     0     43523     43523 1.000000e+00
## 87         chrUn_gl000243     0     43341     43341 1.000000e+00
## 88         chrUn_gl000244     0     39929     39929 1.000000e+00
## 89         chrUn_gl000245     0     36651     36651 1.000000e+00
## 90         chrUn_gl000246     0     38154     38154 1.000000e+00
## 91         chrUn_gl000247     0     36422     36422 1.000000e+00
## 92         chrUn_gl000248     0     39786     39786 1.000000e+00
## 93         chrUn_gl000249     0     38502     38502 1.000000e+00
## 94                   chr1     1   4276763 249250621 1.715848e-02
## 95                   chr2     1   2964701 243199373 1.219041e-02
## 96                   chr3     1   2475193 198022430 1.249956e-02
## 97                   chr4     1   1781762 191154276 9.321068e-03
## 98                   chr5     1   2081422 180915260 1.150496e-02
## 99                   chr6     1   2139394 171115067 1.250266e-02
## 100                  chr7     1   2091042 159138663 1.313975e-02
## 101                  chr8     1   1559886 146364022 1.065758e-02
## 102                  chr9     1   1720912 141213431 1.218660e-02
## 103                 chr10     1   1750080 135534747 1.291241e-02
## 104                 chr11     1   2392545 135006516 1.772170e-02
## 105                 chr12     1   2232213 133851895 1.667674e-02
## 106                 chr13     1    925160 115169878 8.033003e-03
## 107                 chr14     1   1315944 107349540 1.225850e-02
## 108                 chr15     1   1501942 102531392 1.464861e-02
## 109                 chr16     1   1659860  90354753 1.837048e-02
## 110                 chr17     1   2428153  81195210 2.990513e-02
## 111                 chr18     1    825741  78077248 1.057595e-02
## 112                 chr19     1   2560135  59128983 4.329746e-02
## 113                 chr20     1   1000398  63025520 1.587290e-02
## 114                 chr21     1    428502  48129895 8.903032e-03
## 115                 chr22     1    945399  51304566 1.842719e-02
## 116                  chrX     1   1436557 155270560 9.251960e-03
## 117                  chrY     1     99534  59373566 1.676403e-03
## 118  chr1_gl000191_random     1       654    106433 6.144711e-03
## 119  chr1_gl000192_random     1      8867    547496 1.619555e-02
## 120        chr4_ctg9_hap1     1      3147    590426 5.330050e-03
## 121  chr4_gl000193_random     1      1206    189789 6.354425e-03
## 122  chr4_gl000194_random     1      4502    191469 2.351294e-02
## 123         chr6_apd_hap1     1    132915   4622290 2.875523e-02
## 124         chr6_cox_hap2     1    245479   4795371 5.119083e-02
## 125         chr6_dbb_hap3     1    214967   4610396 4.662658e-02
## 126        chr6_mann_hap4     1    184975   4683263 3.949703e-02
## 127         chr6_mcf_hap5     1    209765   4833398 4.339907e-02
## 128         chr6_qbl_hap6     1    222557   4611984 4.825624e-02
## 129        chr6_ssto_hap7     1    205230   4928567 4.164091e-02
## 130  chr7_gl000195_random     1      2413    182896 1.319329e-02
## 131       chr17_ctg5_hap1     1     43106   1680828 2.564569e-02
## 132 chr17_gl000205_random     1      3110    174588 1.781337e-02
## 133 chr19_gl000209_random     1      5420    159169 3.405186e-02
## 134        chrUn_gl000211     1      2521    166566 1.513514e-02
## 135        chrUn_gl000212     1      1962    186858 1.049995e-02
## 136        chrUn_gl000213     1      1826    164239 1.111794e-02
## 137        chrUn_gl000218     1      9059    161147 5.621575e-02
## 138        chrUn_gl000219     1      3662    179198 2.043550e-02
## 139        chrUn_gl000220     1     16302    161802 1.007528e-01
## 140        chrUn_gl000222     1       361    186861 1.931917e-03
## 141        chrUn_gl000223     1       217    180455 1.202516e-03
## 142        chrUn_gl000228     1      3054    129120 2.365242e-02
## 143                  chr1     2   1475526 249250621 5.919849e-03
## 144                  chr2     2    969499 243199373 3.986437e-03
## 145                  chr3     2    815382 198022430 4.117624e-03
## 146                  chr4     2    557906 191154276 2.918616e-03
## 147                  chr5     2    724770 180915260 4.006130e-03
## 148                  chr6     2    803847 171115067 4.697699e-03
## 149                  chr7     2    748669 159138663 4.704507e-03
## 150                  chr8     2    510844 146364022 3.490229e-03
## 151                  chr9     2    611229 141213431 4.328406e-03
## 152                 chr10     2    587136 135534747 4.331996e-03
## 153                 chr11     2    779903 135006516 5.776780e-03
## 154                 chr12     2    724642 133851895 5.413760e-03
## 155                 chr13     2    306111 115169878 2.657909e-03
## 156                 chr14     2    432795 107349540 4.031643e-03
## 157                 chr15     2    581455 102531392 5.670995e-03
## 158                 chr16     2    552925  90354753 6.119490e-03
## 159                 chr17     2    795625  81195210 9.798915e-03
## 160                 chr18     2    222648  78077248 2.851637e-03
## 161                 chr19     2    748851  59128983 1.266470e-02
## 162                 chr20     2    342080  63025520 5.427643e-03
## 163                 chr21     2    144374  48129895 2.999674e-03
## 164                 chr22     2    330979  51304566 6.451258e-03
## 165                  chrX     2    640761 155270560 4.126739e-03
## 166                  chrY     2     75090  59373566 1.264704e-03
## 167  chr1_gl000191_random     2      2361    106433 2.218297e-02
## 168        chr4_ctg9_hap1     2     14399    590426 2.438748e-02
## 169         chr6_apd_hap1     2     39432   4622290 8.530836e-03
## 170         chr6_cox_hap2     2     93207   4795371 1.943687e-02
## 171         chr6_dbb_hap3     2     92106   4610396 1.997789e-02
## 172        chr6_mann_hap4     2     70482   4683263 1.504976e-02
## 173         chr6_mcf_hap5     2     91298   4833398 1.888899e-02
## 174         chr6_qbl_hap6     2     88190   4611984 1.912192e-02
## 175        chr6_ssto_hap7     2     72237   4928567 1.465680e-02
## 176       chr17_ctg5_hap1     2     14439   1680828 8.590409e-03
## 177 chr19_gl000209_random     2      2690    159169 1.690028e-02
## 178        chrUn_gl000218     2       766    161147 4.753424e-03
## 179        chrUn_gl000220     2       156    161802 9.641414e-04
## 180        chrUn_gl000222     2      3241    186861 1.734444e-02
## 181        chrUn_gl000223     2      7015    180455 3.887396e-02
## 182        chrUn_gl000228     2      1380    129120 1.068773e-02
## 183                  chr1     3    710135 249250621 2.849080e-03
## 184                  chr2     3    502710 243199373 2.067069e-03
## 185                  chr3     3    477675 198022430 2.412227e-03
## 186                  chr4     3    275645 191154276 1.442003e-03
## 187                  chr5     3    354758 180915260 1.960907e-03
## 188                  chr6     3    374183 171115067 2.186733e-03
## 189                  chr7     3    307926 159138663 1.934954e-03
## 190                  chr8     3    301381 146364022 2.059119e-03
## 191                  chr9     3    284382 141213431 2.013845e-03
## 192                 chr10     3    297094 135534747 2.192014e-03
## 193                 chr11     3    368023 135006516 2.725965e-03
## 194                 chr12     3    345800 133851895 2.583452e-03
## 195                 chr13     3    129240 115169878 1.122168e-03
## 196                 chr14     3    214613 107349540 1.999198e-03
## 197                 chr15     3    222227 102531392 2.167404e-03
## 198                 chr16     3    259501  90354753 2.872024e-03
## 199                 chr17     3    352239  81195210 4.338175e-03
## 200                 chr18     3     89176  78077248 1.142151e-03
## 201                 chr19     3    332604  59128983 5.625059e-03
## 202                 chr20     3    206624  63025520 3.278418e-03
## 203                 chr21     3     98408  48129895 2.044634e-03
## 204                 chr22     3    119892  51304566 2.336868e-03
## 205                  chrX     3    350856 155270560 2.259643e-03
## 206                  chrY     3     39323  59373566 6.622981e-04
## 207  chr4_gl000194_random     3       690    191469 3.603717e-03
## 208         chr6_apd_hap1     3     18768   4622290 4.060325e-03
## 209         chr6_cox_hap2     3     45608   4795371 9.510839e-03
## 210         chr6_dbb_hap3     3     41678   4610396 9.040004e-03
## 211        chr6_mann_hap4     3     36126   4683263 7.713852e-03
## 212         chr6_mcf_hap5     3     38596   4833398 7.985272e-03
## 213         chr6_qbl_hap6     3     45614   4611984 9.890321e-03
## 214        chr6_ssto_hap7     3     34990   4928567 7.099427e-03
## 215       chr17_ctg5_hap1     3     10845   1680828 6.452177e-03
## 216 chr19_gl000209_random     3      1550    159169 9.738077e-03
## 217        chrUn_gl000223     3      3086    180455 1.710122e-02
## 218        chrUn_gl000228     3      2081    129120 1.611679e-02
## 219                  chr1     4    388193 249250621 1.557440e-03
## 220                  chr2     4    292703 243199373 1.203552e-03
## 221                  chr3     4    188798 198022430 9.534172e-04
## 222                  chr4     4    142692 191154276 7.464756e-04
## 223                  chr5     4    109713 180915260 6.064331e-04
## 224                  chr6     4    249191 171115067 1.456277e-03
## 225                  chr7     4    183171 159138663 1.151015e-03
## 226                  chr8     4    110967 146364022 7.581576e-04
## 227                  chr9     4    111912 141213431 7.925025e-04
## 228                 chr10     4    169837 135534747 1.253088e-03
## 229                 chr11     4    189510 135006516 1.403710e-03
## 230                 chr12     4    189068 133851895 1.412516e-03
## 231                 chr13     4     77558 115169878 6.734226e-04
## 232                 chr14     4    120541 107349540 1.122883e-03
## 233                 chr15     4    132466 102531392 1.291956e-03
## 234                 chr16     4    124394  90354753 1.376729e-03
## 235                 chr17     4    136555  81195210 1.681811e-03
## 236                 chr18     4     46343  78077248 5.935532e-04
## 237                 chr19     4    144736  59128983 2.447801e-03
## 238                 chr20     4     71012  63025520 1.126718e-03
## 239                 chr21     4     51512  48129895 1.070270e-03
## 240                 chr22     4     96121  51304566 1.873537e-03
## 241                  chrX     4    156355 155270560 1.006984e-03
## 242                  chrY     4     17448  59373566 2.938682e-04
## 243  chr1_gl000191_random     4         3    106433 2.818675e-05
## 244  chr4_gl000194_random     4       145    191469 7.573027e-04
## 245         chr6_apd_hap1     4      7186   4622290 1.554641e-03
## 246         chr6_cox_hap2     4     24541   4795371 5.117644e-03
## 247         chr6_dbb_hap3     4     27534   4610396 5.972155e-03
## 248        chr6_mann_hap4     4     16896   4683263 3.607741e-03
## 249         chr6_mcf_hap5     4     19780   4833398 4.092359e-03
## 250         chr6_qbl_hap6     4     24449   4611984 5.301189e-03
## 251        chr6_ssto_hap7     4     26603   4928567 5.397715e-03
## 252       chr17_ctg5_hap1     4       916   1680828 5.449695e-04
## 253 chr19_gl000209_random     4      1475    159169 9.266880e-03
## 254                  chr1     5    179651 249250621 7.207645e-04
## 255                  chr2     5    166609 243199373 6.850717e-04
## 256                  chr3     5     98531 198022430 4.975749e-04
## 257                  chr4     5     66193 191154276 3.462805e-04
## 258                  chr5     5     60796 180915260 3.360468e-04
## 259                  chr6     5     96225 171115067 5.623409e-04
## 260                  chr7     5     85921 159138663 5.399128e-04
## 261                  chr8     5     55775 146364022 3.810704e-04
## 262                  chr9     5     78022 141213431 5.525112e-04
## 263                 chr10     5     61489 135534747 4.536770e-04
## 264                 chr11     5    114796 135006516 8.502997e-04
## 265                 chr12     5    152380 133851895 1.138422e-03
## 266                 chr13     5     29666 115169878 2.575847e-04
## 267                 chr14     5     59841 107349540 5.574407e-04
## 268                 chr15     5     62833 102531392 6.128172e-04
## 269                 chr16     5     61601  90354753 6.817682e-04
## 270                 chr17     5     77806  81195210 9.582585e-04
## 271                 chr18     5     17362  78077248 2.223695e-04
## 272                 chr19     5    106083  59128983 1.794095e-03
## 273                 chr20     5     64676  63025520 1.026187e-03
## 274                 chr21     5     10660  48129895 2.214840e-04
## 275                 chr22     5     44268  51304566 8.628472e-04
## 276                  chrX     5     84151 155270560 5.419637e-04
## 277                  chrY     5      8835  59373566 1.488036e-04
## 278  chr1_gl000191_random     5      1277    106433 1.199816e-02
## 279         chr6_apd_hap1     5      3283   4622290 7.102540e-04
## 280         chr6_cox_hap2     5     13422   4795371 2.798949e-03
## 281         chr6_dbb_hap3     5     12038   4610396 2.611056e-03
## 282        chr6_mann_hap4     5     10732   4683263 2.291565e-03
## 283         chr6_mcf_hap5     5     12428   4833398 2.571276e-03
## 284         chr6_qbl_hap6     5     13046   4611984 2.828718e-03
## 285        chr6_ssto_hap7     5     13717   4928567 2.783162e-03
## 286       chr17_ctg5_hap1     5      2284   1680828 1.358854e-03
## 287                  chr1     6     91005 249250621 3.651144e-04
## 288                  chr2     6    117837 243199373 4.845284e-04
## 289                  chr3     6     69473 198022430 3.508340e-04
## 290                  chr4     6     64342 191154276 3.365972e-04
## 291                  chr5     6     73054 180915260 4.038023e-04
## 292                  chr6     6     49396 171115067 2.886712e-04
## 293                  chr7     6     59477 159138663 3.737432e-04
## 294                  chr8     6     22777 146364022 1.556188e-04
## 295                  chr9     6     42789 141213431 3.030094e-04
## 296                 chr10     6     71202 135534747 5.253413e-04
## 297                 chr11     6     55365 135006516 4.100913e-04
## 298                 chr12     6     48179 133851895 3.599426e-04
## 299                 chr13     6     16843 115169878 1.462448e-04
## 300                 chr14     6     42961 107349540 4.001973e-04
## 301                 chr15     6     36030 102531392 3.514046e-04
## 302                 chr16     6     53522  90354753 5.923540e-04
## 303                 chr17     6     33819  81195210 4.165147e-04
## 304                 chr18     6     17963  78077248 2.300670e-04
## 305                 chr19     6     20575  59128983 3.479681e-04
## 306                 chr20     6     30728  63025520 4.875485e-04
## 307                 chr21     6     19247  48129895 3.998970e-04
## 308                 chr22     6     33595  51304566 6.548150e-04
## 309                  chrX     6     59968 155270560 3.862162e-04
## 310                  chrY     6      1490  59373566 2.509534e-05
## 311  chr1_gl000191_random     6        75    106433 7.046687e-04
## 312         chr6_apd_hap1     6       248   4622290 5.365306e-05
## 313         chr6_cox_hap2     6      9024   4795371 1.881815e-03
## 314         chr6_dbb_hap3     6      8724   4610396 1.892245e-03
## 315        chr6_mann_hap4     6      8724   4683263 1.862804e-03
## 316         chr6_mcf_hap5     6      5518   4833398 1.141640e-03
## 317         chr6_qbl_hap6     6      9024   4611984 1.956642e-03
## 318        chr6_ssto_hap7     6      5325   4928567 1.080436e-03
## 319       chr17_ctg5_hap1     6        87   1680828 5.176020e-05
## 320        chrUn_gl000228     6      4237    129120 3.281444e-02
## 321                  chr1     7     53307 249250621 2.138691e-04
## 322                  chr2     7     74282 243199373 3.054366e-04
## 323                  chr3     7     51171 198022430 2.584101e-04
## 324                  chr4     7     22139 191154276 1.158174e-04
## 325                  chr5     7      2914 180915260 1.610699e-05
## 326                  chr6     7     13548 171115067 7.917479e-05
## 327                  chr7     7     14243 159138663 8.950056e-05
## 328                  chr8     7     11392 146364022 7.783334e-05
## 329                  chr9     7     35136 141213431 2.488149e-04
## 330                 chr10     7     36297 135534747 2.678059e-04
## 331                 chr11     7     42394 135006516 3.140145e-04
## 332                 chr12     7     24453 133851895 1.826870e-04
## 333                 chr13     7     10962 115169878 9.518114e-05
## 334                 chr14     7     15253 107349540 1.420872e-04
## 335                 chr15     7     22034 102531392 2.149000e-04
## 336                 chr16     7     13923  90354753 1.540926e-04
## 337                 chr17     7     32873  81195210 4.048638e-04
## 338                 chr18     7      2768  78077248 3.545207e-05
## 339                 chr19     7     36684  59128983 6.204064e-04
## 340                 chr20     7     11718  63025520 1.859247e-04
## 341                 chr21     7      8288  48129895 1.722007e-04
## 342                 chr22     7     12723  51304566 2.479896e-04
## 343                  chrX     7      9157 155270560 5.897448e-05
## 344                  chrY     7       161  59373566 2.711644e-06
## 345  chr1_gl000191_random     7       621    106433 5.834657e-03
## 346         chr6_apd_hap1     7       810   4622290 1.752378e-04
## 347         chr6_cox_hap2     7       938   4795371 1.956053e-04
## 348         chr6_dbb_hap3     7       886   4610396 1.921744e-04
## 349        chr6_mann_hap4     7       938   4683263 2.002877e-04
## 350         chr6_mcf_hap5     7       938   4833398 1.940664e-04
## 351         chr6_qbl_hap6     7       938   4611984 2.033832e-04
## 352        chr6_ssto_hap7     7       650   4928567 1.318842e-04
## 353        chrUn_gl000228     7      9563    129120 7.406289e-02
## 354                  chr1     8     33862 249250621 1.358552e-04
## 355                  chr2     8     17315 243199373 7.119673e-05
## 356                  chr3     8     32249 198022430 1.628553e-04
## 357                  chr4     8     17962 191154276 9.396599e-05
## 358                  chr5     8      5842 180915260 3.229136e-05
## 359                  chr6     8      7898 171115067 4.615608e-05
## 360                  chr7     8     11184 159138663 7.027833e-05
## 361                  chr8     8     25758 146364022 1.759859e-04
## 362                  chr9     8      8642 141213431 6.119814e-05
## 363                 chr10     8     13603 135534747 1.003654e-04
## 364                 chr11     8     21606 135006516 1.600367e-04
## 365                 chr12     8     27187 133851895 2.031126e-04
## 366                 chr13     8       660 115169878 5.730665e-06
## 367                 chr14     8      6431 107349540 5.990710e-05
## 368                 chr15     8      3677 102531392 3.586219e-05
## 369                 chr16     8     13720  90354753 1.518459e-04
## 370                 chr17     8     10710  81195210 1.319043e-04
## 371                 chr18     8      8755  78077248 1.121325e-04
## 372                 chr19     8     15269  59128983 2.582321e-04
## 373                 chr20     8     11919  63025520 1.891139e-04
## 374                 chr21     8     10947  48129895 2.274470e-04
## 375                 chr22     8      5330  51304566 1.038894e-04
## 376                  chrX     8     27576 155270560 1.775997e-04
## 377                  chrY     8       322  59373566 5.423289e-06
## 378         chr6_apd_hap1     8      1488   4622290 3.219184e-04
## 379         chr6_cox_hap2     8      1488   4795371 3.102992e-04
## 380         chr6_dbb_hap3     8      1356   4610396 2.941179e-04
## 381        chr6_mann_hap4     8      1488   4683263 3.177272e-04
## 382         chr6_mcf_hap5     8      1488   4833398 3.078580e-04
## 383         chr6_qbl_hap6     8      1488   4611984 3.226377e-04
## 384        chr6_ssto_hap7     8       592   4928567 1.201160e-04
## 385       chr17_ctg5_hap1     8      5540   1680828 3.295995e-03
## 386                  chr1     9      8961 249250621 3.595177e-05
## 387                  chr2     9      4898 243199373 2.013985e-05
## 388                  chr3     9      3187 198022430 1.609414e-05
## 389                  chr4     9      9362 191154276 4.897615e-05
## 390                  chr5     9      9715 180915260 5.369917e-05
## 391                  chr6     9      6373 171115067 3.724394e-05
## 392                  chr7     9      2367 159138663 1.487382e-05
## 393                  chr8     9     10190 146364022 6.962093e-05
## 394                  chr9     9      2955 141213431 2.092577e-05
## 395                 chr10     9      9569 135534747 7.060182e-05
## 396                 chr11     9     10595 135006516 7.847769e-05
## 397                 chr12     9     15074 133851895 1.126170e-04
## 398                 chr14     9      2961 107349540 2.758279e-05
## 399                 chr15     9      4283 102531392 4.177257e-05
## 400                 chr16     9      6950  90354753 7.691903e-05
## 401                 chr17     9      9279  81195210 1.142801e-04
## 402                 chr18     9      4477  78077248 5.734065e-05
## 403                 chr19     9      4270  59128983 7.221501e-05
## 404                 chr20     9      2434  63025520 3.861928e-05
## 405                 chr22     9      3897  51304566 7.595815e-05
## 406                  chrX     9      9361 155270560 6.028831e-05
## 407                  chrY     9       923  59373566 1.554564e-05
## 408         chr6_apd_hap1     9      1526   4622290 3.301394e-04
## 409         chr6_cox_hap2     9      1530   4795371 3.190577e-04
## 410         chr6_dbb_hap3     9      1428   4610396 3.097348e-04
## 411        chr6_mann_hap4     9      1522   4683263 3.249871e-04
## 412         chr6_mcf_hap5     9      1518   4833398 3.140648e-04
## 413         chr6_qbl_hap6     9      1526   4611984 3.308771e-04
## 414        chr6_ssto_hap7     9      1522   4928567 3.088119e-04
## 415                  chr1    10     11434 249250621 4.587351e-05
## 416                  chr2    10      5372 243199373 2.208887e-05
## 417                  chr3    10       727 198022430 3.671301e-06
## 418                  chr4    10       592 191154276 3.096975e-06
## 419                  chr5    10      4025 180915260 2.224799e-05
## 420                  chr6    10     20687 171115067 1.208953e-04
## 421                  chr7    10       156 159138663 9.802772e-07
## 422                  chr8    10       568 146364022 3.880735e-06
## 423                  chr9    10      4795 141213431 3.395569e-05
## 424                 chr10    10      6872 135534747 5.070287e-05
## 425                 chr11    10      6555 135006516 4.855321e-05
## 426                 chr12    10     14113 133851895 1.054374e-04
## 427                 chr14    10      1557 107349540 1.450402e-05
## 428                 chr15    10      5450 102531392 5.315445e-05
## 429                 chr16    10        99  90354753 1.095681e-06
## 430                 chr17    10      1295  81195210 1.594922e-05
## 431                 chr18    10      9475  78077248 1.213542e-04
## 432                 chr19    10      4129  59128983 6.983039e-05
## 433                 chr20    10      1605  63025520 2.546587e-05
## 434                 chr21    10      2929  48129895 6.085615e-05
## 435                 chr22    10       523  51304566 1.019402e-05
## 436                  chrX    10      3134 155270560 2.018412e-05
## 437                  chrY    10       595  59373566 1.002129e-05
## 438         chr6_apd_hap1    10      1108   4622290 2.397080e-04
## 439         chr6_cox_hap2    10      1108   4795371 2.310562e-04
## 440         chr6_dbb_hap3    10        27   4610396 5.856330e-06
## 441        chr6_mann_hap4    10      1108   4683263 2.365872e-04
## 442         chr6_mcf_hap5    10      1108   4833398 2.292383e-04
## 443         chr6_qbl_hap6    10      1108   4611984 2.402437e-04
## 444        chr6_ssto_hap7    10      1108   4928567 2.248118e-04
## 445                  chr1    11      2253 249250621 9.039095e-06
## 446                  chr2    11      3051 243199373 1.254526e-05
## 447                  chr3    11      2620 198022430 1.323082e-05
## 448                  chr4    11      4326 191154276 2.263094e-05
## 449                  chr5    11      6357 180915260 3.513800e-05
## 450                  chr7    11       150 159138663 9.425742e-07
## 451                  chr8    11       727 146364022 4.967068e-06
## 452                  chr9    11      2047 141213431 1.449579e-05
## 453                 chr10    11     11230 135534747 8.285698e-05
## 454                 chr11    11       157 135006516 1.162907e-06
## 455                 chr12    11       168 133851895 1.255119e-06
## 456                 chr14    11      2963 107349540 2.760142e-05
## 457                 chr16    11       289  90354753 3.198504e-06
## 458                 chr17    11      3528  81195210 4.345084e-05
## 459                 chr18    11      1380  78077248 1.767480e-05
## 460                 chr19    11       276  59128983 4.667762e-06
## 461                 chr20    11      2073  63025520 3.289144e-05
## 462                 chr21    11        55  48129895 1.142741e-06
## 463                 chr22    11       174  51304566 3.391511e-06
## 464                  chrX    11     13537 155270560 8.718330e-05
## 465                  chr1    12      4582 249250621 1.838310e-05
## 466                  chr2    12      3993 243199373 1.641863e-05
## 467                  chr3    12       719 198022430 3.630902e-06
## 468                  chr4    12      4089 191154276 2.139110e-05
## 469                  chr5    12       294 180915260 1.625070e-06
## 470                  chr6    12        97 171115067 5.668700e-07
## 471                  chr7    12      1804 159138663 1.133603e-05
## 472                  chr8    12       502 146364022 3.429805e-06
## 473                  chr9    12      1783 141213431 1.262628e-05
## 474                 chr10    12     10710 135534747 7.902033e-05
## 475                 chr11    12      3218 135006516 2.383589e-05
## 476                 chr12    12       606 133851895 4.527392e-06
## 477                 chr14    12        19 107349540 1.769919e-07
## 478                 chr17    12       351  81195210 4.322915e-06
## 479                 chr18    12      8314  78077248 1.064843e-04
## 480                 chr19    12      3673  59128983 6.211844e-05
## 481                 chr20    12       241  63025520 3.823848e-06
## 482                  chrX    12      6990 155270560 4.501819e-05
## 483                  chrY    12        15  59373566 2.526377e-07
## 484                  chr1    13      7406 249250621 2.971307e-05
## 485                  chr2    13      4977 243199373 2.046469e-05
## 486                  chr3    13      5705 198022430 2.880987e-05
## 487                  chr4    13      1152 191154276 6.026546e-06
## 488                  chr5    13      2630 180915260 1.453719e-05
## 489                  chr7    13      8714 159138663 5.475728e-05
## 490                  chr9    13      9665 141213431 6.844250e-05
## 491                 chr10    13      5886 135534747 4.342798e-05
## 492                 chr11    13       199 135006516 1.474003e-06
## 493                 chr14    13        98 107349540 9.129056e-07
## 494                 chr17    13       279  81195210 3.436163e-06
## 495                 chr18    13       258  78077248 3.304420e-06
## 496                 chr19    13       868  59128983 1.467977e-05
## 497                 chr20    13      3108  63025520 4.931336e-05
## 498                 chr22    13      4284  51304566 8.350134e-05
## 499                  chrX    13       139 155270560 8.952116e-07
## 500                  chr1    14       684 249250621 2.744226e-06
## 501                  chr2    14      6384 243199373 2.625007e-05
## 502                  chr3    14       148 198022430 7.473901e-07
## 503                  chr5    14      5146 180915260 2.844426e-05
## 504                 chr10    14       592 135534747 4.367884e-06
## 505                 chr11    14       602 135006516 4.459044e-06
## 506                 chr14    14      1815 107349540 1.690738e-05
## 507                 chr17    14        65  81195210 8.005398e-07
## 508                 chr18    14      1352  78077248 1.731618e-05
## 509                 chr19    14       147  59128983 2.486090e-06
## 510                 chr20    14       303  63025520 4.807576e-06
## 511                 chr22    14      1689  51304566 3.292105e-05
## 512                  chrX    14       291 155270560 1.874148e-06
## 513                  chr1    15      1153 249250621 4.625866e-06
## 514                  chr5    15      2036 180915260 1.125389e-05
## 515                  chr8    15      9795 146364022 6.692218e-05
## 516                 chr10    15       143 135534747 1.055080e-06
## 517                 chr11    15       365 135006516 2.703573e-06
## 518                 chr12    15        60 133851895 4.482566e-07
## 519                 chr14    15       357 107349540 3.325585e-06
## 520                 chr17    15      2137  81195210 2.631929e-05
## 521                 chr18    15       309  78077248 3.957619e-06
## 522                 chr20    15       910  63025520 1.443860e-05
## 523                 chr21    15        44  48129895 9.141927e-07
## 524                  chrX    15      2060 155270560 1.326716e-05
## 525                  chr1    16      4626 249250621 1.855963e-05
## 526                  chr2    16      4313 243199373 1.773442e-05
## 527                  chr3    16       106 198022430 5.352929e-07
## 528                  chr6    16        96 171115067 5.610260e-07
## 529                 chr10    16       196 135534747 1.446124e-06
## 530                 chr11    16        22 135006516 1.629551e-07
## 531                 chr12    16         6 133851895 4.482566e-08
## 532                 chr14    16      1121 107349540 1.044252e-05
## 533                 chr17    16      8779  81195210 1.081221e-04
## 534                 chr18    16       209  78077248 2.676836e-06
## 535                 chr20    16      2337  63025520 3.708022e-05
## 536                  chrX    16      4808 155270560 3.096530e-05
## 537                  chrY    16        32  59373566 5.389604e-07
## 538                  chr1    17        50 249250621 2.006013e-07
## 539                  chr6    17       424 171115067 2.477865e-06
## 540                  chr8    17       130 146364022 8.881964e-07
## 541                 chr11    17      3545 135006516 2.625799e-05
## 542                 chr12    17       111 133851895 8.292748e-07
## 543                 chr20    17      4683  63025520 7.430323e-05
## 544                  chrX    17       999 155270560 6.433931e-06
## 545                  chr1    18       337 249250621 1.352053e-06
## 546                  chr2    18       412 243199373 1.694083e-06
## 547                  chr3    18       104 198022430 5.251930e-07
## 548                  chr5    18      2866 180915260 1.584167e-05
## 549                  chr6    18      3310 171115067 1.934371e-05
## 550                 chr10    18       226 135534747 1.667469e-06
## 551                 chr11    18      3549 135006516 2.628762e-05
## 552                 chr14    18       165 107349540 1.537035e-06
## 553                 chr20    18      2388  63025520 3.788941e-05
## 554                 chr21    18        85  48129895 1.766054e-06
## 555                  chr1    19        36 249250621 1.444329e-07
## 556                 chr11    19       253 135006516 1.873984e-06
## 557                 chr12    19       104 133851895 7.769782e-07
## 558                 chr17    19       637  81195210 7.845290e-06
## 559                  chr1    20      1080 249250621 4.332988e-06
## 560                 chr10    20      3416 135534747 2.520387e-05
## 561                 chr11    20        63 135006516 4.666441e-07
## 562                 chr14    20       223 107349540 2.077326e-06
## 563                 chr21    20      1547  48129895 3.214219e-05
## 564                  chr1    21       366 249250621 1.468402e-06
## 565                  chr6    21       353 171115067 2.062939e-06
## 566                 chr17    21        22  81195210 2.709519e-07
## 567                  chrY    21        58  59373566 9.768657e-07
## 568                  chr1    22        93 249250621 3.731184e-07
## 569                  chr5    22         2 180915260 1.105490e-08
## 570                  chr6    22       521 171115067 3.044735e-06
## 571                 chr11    22      1827 135006516 1.353268e-05
## 572                 chr12    22         9 133851895 6.723850e-08
## 573                 chr19    22       245  59128983 4.143484e-06
## 574                  chr1    23       163 249250621 6.539603e-07
## 575                 chr11    23      5344 135006516 3.958327e-05
## 576                 chr12    23     12758 133851895 9.531430e-05
## 577                 chr14    23       277 107349540 2.580356e-06
## 578                 chr17    23       126  81195210 1.551816e-06
## 579                  chr1    24        95 249250621 3.811425e-07
## 580                  chr5    24      2179 180915260 1.204431e-05
## 581                 chr12    24       432 133851895 3.227448e-06
## 582                 chr14    24        97 107349540 9.035903e-07
## 583                  chr1    25      1494 249250621 5.993967e-06
## 584                 chr17    25        75  81195210 9.236998e-07
## 585                 chr10    26      1303 135534747 9.613771e-06
## 586                 chr17    26         6  81195210 7.389598e-08
## 587                  chr1    27        70 249250621 2.808418e-07
## 588                 chr10    28       157 135534747 1.158375e-06
## 589                 chr17    28        70  81195210 8.621198e-07
## 590                  chrY    28       135  59373566 2.273739e-06
## 591                  chr1    30       980 249250621 3.931786e-06
## 592                 chr17    30       289  81195210 3.559323e-06
## 593                 chr14    31      6075 107349540 5.659083e-05
## 594                 chr17    31        88  81195210 1.083808e-06
## 595                 chr17    32       112  81195210 1.379392e-06
## 596                 chr17    33      7435  81195210 9.156944e-05
## 597                  chrY    45       535  59373566 9.010744e-06
## 598                  chrY    49       238  59373566 4.008518e-06
## 599                  chrY    63       282  59373566 4.749588e-06
## 600                  chrY    64        90  59373566 1.515826e-06
## 601                  chrY    66       171  59373566 2.880070e-06
## 602                  chrY    69        35  59373566 5.894879e-07
## 603                  chrY    70        48  59373566 8.084406e-07
## 604                  chrY    73       135  59373566 2.273739e-06
## 605                  chrY    74       263  59373566 4.429581e-06
## 606                  chrY    75      1921  59373566 3.235447e-05
## 607                  chrY    76       705  59373566 1.187397e-05
## 608                  chrY    77      2103  59373566 3.541980e-05</code></pre>
<p>Similarly for the genome-wide coverage histogram, we perform the same operation but do not group over <code>seqnames</code>. Finally we bind the resulting <code>tibbles</code> together.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvg_hist_total &lt;-<span class="st"> </span>cvg <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(score) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">count =</span> <span class="kw">sum</span>(<span class="kw">as.numeric</span>(width))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">seqnames =</span> <span class="st">"genome"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(.,
            hg19 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">              </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">width =</span> <span class="kw">sum</span>(<span class="kw">as.numeric</span>(width))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">              </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">seqnames =</span> <span class="st">"genome"</span>) <span class="op">%&gt;%</span>
<span class="st">              </span><span class="kw">as.data.frame</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">fraction =</span> count <span class="op">/</span><span class="st"> </span>width)</code></pre></div>
<pre><code>## Joining, by = "seqnames"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvg_hist_total</code></pre></div>
<pre><code>##    score      count seqnames      width     fraction
## 1      0 3062406951   genome 3137161264 9.761714e-01
## 2      1   44120515   genome 3137161264 1.406383e-02
## 3      2   15076446   genome 3137161264 4.805761e-03
## 4      3    7294047   genome 3137161264 2.325047e-03
## 5      4    3650324   genome 3137161264 1.163576e-03
## 6      5    1926397   genome 3137161264 6.140574e-04
## 7      6    1182623   genome 3137161264 3.769723e-04
## 8      7     574102   genome 3137161264 1.830005e-04
## 9      8     353352   genome 3137161264 1.126343e-04
## 10     9     152653   genome 3137161264 4.865960e-05
## 11    10     113362   genome 3137161264 3.613522e-05
## 12    11      57361   genome 3137161264 1.828436e-05
## 13    12      52000   genome 3137161264 1.657549e-05
## 14    13      55368   genome 3137161264 1.764908e-05
## 15    14      19218   genome 3137161264 6.125920e-06
## 16    15      19369   genome 3137161264 6.174053e-06
## 17    16      26651   genome 3137161264 8.495260e-06
## 18    17       9942   genome 3137161264 3.169107e-06
## 19    18      13442   genome 3137161264 4.284765e-06
## 20    19       1030   genome 3137161264 3.283223e-07
## 21    20       6329   genome 3137161264 2.017429e-06
## 22    21        799   genome 3137161264 2.546889e-07
## 23    22       2697   genome 3137161264 8.596944e-07
## 24    23      18668   genome 3137161264 5.950603e-06
## 25    24       2803   genome 3137161264 8.934829e-07
## 26    25       1569   genome 3137161264 5.001337e-07
## 27    26       1309   genome 3137161264 4.172562e-07
## 28    27         70   genome 3137161264 2.231317e-08
## 29    28        362   genome 3137161264 1.153909e-07
## 30    30       1269   genome 3137161264 4.045058e-07
## 31    31       6163   genome 3137161264 1.964515e-06
## 32    32        112   genome 3137161264 3.570107e-08
## 33    33       7435   genome 3137161264 2.369977e-06
## 34    45        535   genome 3137161264 1.705363e-07
## 35    49        238   genome 3137161264 7.586476e-08
## 36    63        282   genome 3137161264 8.989018e-08
## 37    64         90   genome 3137161264 2.868836e-08
## 38    66        171   genome 3137161264 5.450788e-08
## 39    69         35   genome 3137161264 1.115658e-08
## 40    70         48   genome 3137161264 1.530046e-08
## 41    73        135   genome 3137161264 4.303253e-08
## 42    74        263   genome 3137161264 8.383375e-08
## 43    75       1921   genome 3137161264 6.123370e-07
## 44    76        705   genome 3137161264 2.247255e-07
## 45    77       2103   genome 3137161264 6.703513e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvg_hist &lt;-<span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(cvg_hist_by_seq, cvg_hist_total)
cvg_hist</code></pre></div>
<pre><code>##                  seqnames score      count      width     fraction
## 1                    chr1     0  241996316  249250621 9.708955e-01
## 2                    chr2     0  238060317  243199373 9.788690e-01
## 3                    chr3     0  193800642  198022430 9.786803e-01
## 4                    chr4     0  188206114  191154276 9.845771e-01
## 5                    chr5     0  177466741  180915260 9.809385e-01
## 6                    chr6     0  167349524  171115067 9.779941e-01
## 7                    chr7     0  155623839  159138663 9.779135e-01
## 8                    chr8     0  143743330  146364022 9.820947e-01
## 9                    chr9     0  138299162  141213431 9.793627e-01
## 10                  chr10     0  132497709  135534747 9.775922e-01
## 11                  chr11     0  131006080  135006516 9.703686e-01
## 12                  chr12     0  130064532  133851895 9.717048e-01
## 13                  chr13     0  113673678  115169878 9.870088e-01
## 14                  chr14     0  105123433  107349540 9.792630e-01
## 15                  chr15     0   99958995  102531392 9.749111e-01
## 16                  chr16     0   87607969   90354753 9.696000e-01
## 17                  chr17     0   77292857   81195210 9.519386e-01
## 18                  chr18     0   76820718   78077248 9.839066e-01
## 19                  chr19     0   55150438   59128983 9.327141e-01
## 20                  chr20     0   61266283   63025520 9.720869e-01
## 21                  chr21     0   47353297   48129895 9.838645e-01
## 22                  chr22     0   49705692   51304566 9.688356e-01
## 23                   chrX     0  152463860  155270560 9.819238e-01
## 24                   chrY     0   59123079   59373566 9.957812e-01
## 25                   chrM     0      16571      16571 1.000000e+00
## 26   chr1_gl000191_random     0     101442     106433 9.531066e-01
## 27   chr1_gl000192_random     0     538629     547496 9.838044e-01
## 28         chr4_ctg9_hap1     0     572880     590426 9.702825e-01
## 29   chr4_gl000193_random     0     188583     189789 9.936456e-01
## 30   chr4_gl000194_random     0     186132     191469 9.721260e-01
## 31          chr6_apd_hap1     0    4415526    4622290 9.552681e-01
## 32          chr6_cox_hap2     0    4359026    4795371 9.090070e-01
## 33          chr6_dbb_hap3     0    4209652    4610396 9.130782e-01
## 34         chr6_mann_hap4     0    4350272    4683263 9.288977e-01
## 35          chr6_mcf_hap5     0    4450961    4833398 9.208762e-01
## 36          chr6_qbl_hap6     0    4204044    4611984 9.115478e-01
## 37         chr6_ssto_hap7     0    4566593    4928567 9.265559e-01
## 38   chr7_gl000195_random     0     180483     182896 9.868067e-01
## 39   chr8_gl000196_random     0      38914      38914 1.000000e+00
## 40   chr8_gl000197_random     0      37175      37175 1.000000e+00
## 41   chr9_gl000198_random     0      90085      90085 1.000000e+00
## 42   chr9_gl000199_random     0     169874     169874 1.000000e+00
## 43   chr9_gl000200_random     0     187035     187035 1.000000e+00
## 44   chr9_gl000201_random     0      36148      36148 1.000000e+00
## 45  chr11_gl000202_random     0      40103      40103 1.000000e+00
## 46        chr17_ctg5_hap1     0    1603611    1680828 9.540601e-01
## 47  chr17_gl000203_random     0      37498      37498 1.000000e+00
## 48  chr17_gl000204_random     0      81310      81310 1.000000e+00
## 49  chr17_gl000205_random     0     171478     174588 9.821866e-01
## 50  chr17_gl000206_random     0      41001      41001 1.000000e+00
## 51  chr18_gl000207_random     0       4262       4262 1.000000e+00
## 52  chr19_gl000208_random     0      92689      92689 1.000000e+00
## 53  chr19_gl000209_random     0     148034     159169 9.300429e-01
## 54  chr21_gl000210_random     0      27682      27682 1.000000e+00
## 55         chrUn_gl000211     0     164045     166566 9.848649e-01
## 56         chrUn_gl000212     0     184896     186858 9.895000e-01
## 57         chrUn_gl000213     0     162413     164239 9.888821e-01
## 58         chrUn_gl000214     0     137718     137718 1.000000e+00
## 59         chrUn_gl000215     0     172545     172545 1.000000e+00
## 60         chrUn_gl000216     0     172294     172294 1.000000e+00
## 61         chrUn_gl000217     0     172149     172149 1.000000e+00
## 62         chrUn_gl000218     0     151322     161147 9.390308e-01
## 63         chrUn_gl000219     0     175536     179198 9.795645e-01
## 64         chrUn_gl000220     0     145344     161802 8.982831e-01
## 65         chrUn_gl000221     0     155397     155397 1.000000e+00
## 66         chrUn_gl000222     0     183259     186861 9.807236e-01
## 67         chrUn_gl000223     0     170137     180455 9.428223e-01
## 68         chrUn_gl000224     0     179693     179693 1.000000e+00
## 69         chrUn_gl000225     0     211173     211173 1.000000e+00
## 70         chrUn_gl000226     0      15008      15008 1.000000e+00
## 71         chrUn_gl000227     0     128374     128374 1.000000e+00
## 72         chrUn_gl000228     0     108805     129120 8.426657e-01
## 73         chrUn_gl000229     0      19913      19913 1.000000e+00
## 74         chrUn_gl000230     0      43691      43691 1.000000e+00
## 75         chrUn_gl000231     0      27386      27386 1.000000e+00
## 76         chrUn_gl000232     0      40652      40652 1.000000e+00
## 77         chrUn_gl000233     0      45941      45941 1.000000e+00
## 78         chrUn_gl000234     0      40531      40531 1.000000e+00
## 79         chrUn_gl000235     0      34474      34474 1.000000e+00
## 80         chrUn_gl000236     0      41934      41934 1.000000e+00
## 81         chrUn_gl000237     0      45867      45867 1.000000e+00
## 82         chrUn_gl000238     0      39939      39939 1.000000e+00
## 83         chrUn_gl000239     0      33824      33824 1.000000e+00
## 84         chrUn_gl000240     0      41933      41933 1.000000e+00
## 85         chrUn_gl000241     0      42152      42152 1.000000e+00
## 86         chrUn_gl000242     0      43523      43523 1.000000e+00
## 87         chrUn_gl000243     0      43341      43341 1.000000e+00
## 88         chrUn_gl000244     0      39929      39929 1.000000e+00
## 89         chrUn_gl000245     0      36651      36651 1.000000e+00
## 90         chrUn_gl000246     0      38154      38154 1.000000e+00
## 91         chrUn_gl000247     0      36422      36422 1.000000e+00
## 92         chrUn_gl000248     0      39786      39786 1.000000e+00
## 93         chrUn_gl000249     0      38502      38502 1.000000e+00
## 94                   chr1     1    4276763  249250621 1.715848e-02
## 95                   chr2     1    2964701  243199373 1.219041e-02
## 96                   chr3     1    2475193  198022430 1.249956e-02
## 97                   chr4     1    1781762  191154276 9.321068e-03
## 98                   chr5     1    2081422  180915260 1.150496e-02
## 99                   chr6     1    2139394  171115067 1.250266e-02
## 100                  chr7     1    2091042  159138663 1.313975e-02
## 101                  chr8     1    1559886  146364022 1.065758e-02
## 102                  chr9     1    1720912  141213431 1.218660e-02
## 103                 chr10     1    1750080  135534747 1.291241e-02
## 104                 chr11     1    2392545  135006516 1.772170e-02
## 105                 chr12     1    2232213  133851895 1.667674e-02
## 106                 chr13     1     925160  115169878 8.033003e-03
## 107                 chr14     1    1315944  107349540 1.225850e-02
## 108                 chr15     1    1501942  102531392 1.464861e-02
## 109                 chr16     1    1659860   90354753 1.837048e-02
## 110                 chr17     1    2428153   81195210 2.990513e-02
## 111                 chr18     1     825741   78077248 1.057595e-02
## 112                 chr19     1    2560135   59128983 4.329746e-02
## 113                 chr20     1    1000398   63025520 1.587290e-02
## 114                 chr21     1     428502   48129895 8.903032e-03
## 115                 chr22     1     945399   51304566 1.842719e-02
## 116                  chrX     1    1436557  155270560 9.251960e-03
## 117                  chrY     1      99534   59373566 1.676403e-03
## 118  chr1_gl000191_random     1        654     106433 6.144711e-03
## 119  chr1_gl000192_random     1       8867     547496 1.619555e-02
## 120        chr4_ctg9_hap1     1       3147     590426 5.330050e-03
## 121  chr4_gl000193_random     1       1206     189789 6.354425e-03
## 122  chr4_gl000194_random     1       4502     191469 2.351294e-02
## 123         chr6_apd_hap1     1     132915    4622290 2.875523e-02
## 124         chr6_cox_hap2     1     245479    4795371 5.119083e-02
## 125         chr6_dbb_hap3     1     214967    4610396 4.662658e-02
## 126        chr6_mann_hap4     1     184975    4683263 3.949703e-02
## 127         chr6_mcf_hap5     1     209765    4833398 4.339907e-02
## 128         chr6_qbl_hap6     1     222557    4611984 4.825624e-02
## 129        chr6_ssto_hap7     1     205230    4928567 4.164091e-02
## 130  chr7_gl000195_random     1       2413     182896 1.319329e-02
## 131       chr17_ctg5_hap1     1      43106    1680828 2.564569e-02
## 132 chr17_gl000205_random     1       3110     174588 1.781337e-02
## 133 chr19_gl000209_random     1       5420     159169 3.405186e-02
## 134        chrUn_gl000211     1       2521     166566 1.513514e-02
## 135        chrUn_gl000212     1       1962     186858 1.049995e-02
## 136        chrUn_gl000213     1       1826     164239 1.111794e-02
## 137        chrUn_gl000218     1       9059     161147 5.621575e-02
## 138        chrUn_gl000219     1       3662     179198 2.043550e-02
## 139        chrUn_gl000220     1      16302     161802 1.007528e-01
## 140        chrUn_gl000222     1        361     186861 1.931917e-03
## 141        chrUn_gl000223     1        217     180455 1.202516e-03
## 142        chrUn_gl000228     1       3054     129120 2.365242e-02
## 143                  chr1     2    1475526  249250621 5.919849e-03
## 144                  chr2     2     969499  243199373 3.986437e-03
## 145                  chr3     2     815382  198022430 4.117624e-03
## 146                  chr4     2     557906  191154276 2.918616e-03
## 147                  chr5     2     724770  180915260 4.006130e-03
## 148                  chr6     2     803847  171115067 4.697699e-03
## 149                  chr7     2     748669  159138663 4.704507e-03
## 150                  chr8     2     510844  146364022 3.490229e-03
## 151                  chr9     2     611229  141213431 4.328406e-03
## 152                 chr10     2     587136  135534747 4.331996e-03
## 153                 chr11     2     779903  135006516 5.776780e-03
## 154                 chr12     2     724642  133851895 5.413760e-03
## 155                 chr13     2     306111  115169878 2.657909e-03
## 156                 chr14     2     432795  107349540 4.031643e-03
## 157                 chr15     2     581455  102531392 5.670995e-03
## 158                 chr16     2     552925   90354753 6.119490e-03
## 159                 chr17     2     795625   81195210 9.798915e-03
## 160                 chr18     2     222648   78077248 2.851637e-03
## 161                 chr19     2     748851   59128983 1.266470e-02
## 162                 chr20     2     342080   63025520 5.427643e-03
## 163                 chr21     2     144374   48129895 2.999674e-03
## 164                 chr22     2     330979   51304566 6.451258e-03
## 165                  chrX     2     640761  155270560 4.126739e-03
## 166                  chrY     2      75090   59373566 1.264704e-03
## 167  chr1_gl000191_random     2       2361     106433 2.218297e-02
## 168        chr4_ctg9_hap1     2      14399     590426 2.438748e-02
## 169         chr6_apd_hap1     2      39432    4622290 8.530836e-03
## 170         chr6_cox_hap2     2      93207    4795371 1.943687e-02
## 171         chr6_dbb_hap3     2      92106    4610396 1.997789e-02
## 172        chr6_mann_hap4     2      70482    4683263 1.504976e-02
## 173         chr6_mcf_hap5     2      91298    4833398 1.888899e-02
## 174         chr6_qbl_hap6     2      88190    4611984 1.912192e-02
## 175        chr6_ssto_hap7     2      72237    4928567 1.465680e-02
## 176       chr17_ctg5_hap1     2      14439    1680828 8.590409e-03
## 177 chr19_gl000209_random     2       2690     159169 1.690028e-02
## 178        chrUn_gl000218     2        766     161147 4.753424e-03
## 179        chrUn_gl000220     2        156     161802 9.641414e-04
## 180        chrUn_gl000222     2       3241     186861 1.734444e-02
## 181        chrUn_gl000223     2       7015     180455 3.887396e-02
## 182        chrUn_gl000228     2       1380     129120 1.068773e-02
## 183                  chr1     3     710135  249250621 2.849080e-03
## 184                  chr2     3     502710  243199373 2.067069e-03
## 185                  chr3     3     477675  198022430 2.412227e-03
## 186                  chr4     3     275645  191154276 1.442003e-03
## 187                  chr5     3     354758  180915260 1.960907e-03
## 188                  chr6     3     374183  171115067 2.186733e-03
## 189                  chr7     3     307926  159138663 1.934954e-03
## 190                  chr8     3     301381  146364022 2.059119e-03
## 191                  chr9     3     284382  141213431 2.013845e-03
## 192                 chr10     3     297094  135534747 2.192014e-03
## 193                 chr11     3     368023  135006516 2.725965e-03
## 194                 chr12     3     345800  133851895 2.583452e-03
## 195                 chr13     3     129240  115169878 1.122168e-03
## 196                 chr14     3     214613  107349540 1.999198e-03
## 197                 chr15     3     222227  102531392 2.167404e-03
## 198                 chr16     3     259501   90354753 2.872024e-03
## 199                 chr17     3     352239   81195210 4.338175e-03
## 200                 chr18     3      89176   78077248 1.142151e-03
## 201                 chr19     3     332604   59128983 5.625059e-03
## 202                 chr20     3     206624   63025520 3.278418e-03
## 203                 chr21     3      98408   48129895 2.044634e-03
## 204                 chr22     3     119892   51304566 2.336868e-03
## 205                  chrX     3     350856  155270560 2.259643e-03
## 206                  chrY     3      39323   59373566 6.622981e-04
## 207  chr4_gl000194_random     3        690     191469 3.603717e-03
## 208         chr6_apd_hap1     3      18768    4622290 4.060325e-03
## 209         chr6_cox_hap2     3      45608    4795371 9.510839e-03
## 210         chr6_dbb_hap3     3      41678    4610396 9.040004e-03
## 211        chr6_mann_hap4     3      36126    4683263 7.713852e-03
## 212         chr6_mcf_hap5     3      38596    4833398 7.985272e-03
## 213         chr6_qbl_hap6     3      45614    4611984 9.890321e-03
## 214        chr6_ssto_hap7     3      34990    4928567 7.099427e-03
## 215       chr17_ctg5_hap1     3      10845    1680828 6.452177e-03
## 216 chr19_gl000209_random     3       1550     159169 9.738077e-03
## 217        chrUn_gl000223     3       3086     180455 1.710122e-02
## 218        chrUn_gl000228     3       2081     129120 1.611679e-02
## 219                  chr1     4     388193  249250621 1.557440e-03
## 220                  chr2     4     292703  243199373 1.203552e-03
## 221                  chr3     4     188798  198022430 9.534172e-04
## 222                  chr4     4     142692  191154276 7.464756e-04
## 223                  chr5     4     109713  180915260 6.064331e-04
## 224                  chr6     4     249191  171115067 1.456277e-03
## 225                  chr7     4     183171  159138663 1.151015e-03
## 226                  chr8     4     110967  146364022 7.581576e-04
## 227                  chr9     4     111912  141213431 7.925025e-04
## 228                 chr10     4     169837  135534747 1.253088e-03
## 229                 chr11     4     189510  135006516 1.403710e-03
## 230                 chr12     4     189068  133851895 1.412516e-03
## 231                 chr13     4      77558  115169878 6.734226e-04
## 232                 chr14     4     120541  107349540 1.122883e-03
## 233                 chr15     4     132466  102531392 1.291956e-03
## 234                 chr16     4     124394   90354753 1.376729e-03
## 235                 chr17     4     136555   81195210 1.681811e-03
## 236                 chr18     4      46343   78077248 5.935532e-04
## 237                 chr19     4     144736   59128983 2.447801e-03
## 238                 chr20     4      71012   63025520 1.126718e-03
## 239                 chr21     4      51512   48129895 1.070270e-03
## 240                 chr22     4      96121   51304566 1.873537e-03
## 241                  chrX     4     156355  155270560 1.006984e-03
## 242                  chrY     4      17448   59373566 2.938682e-04
## 243  chr1_gl000191_random     4          3     106433 2.818675e-05
## 244  chr4_gl000194_random     4        145     191469 7.573027e-04
## 245         chr6_apd_hap1     4       7186    4622290 1.554641e-03
## 246         chr6_cox_hap2     4      24541    4795371 5.117644e-03
## 247         chr6_dbb_hap3     4      27534    4610396 5.972155e-03
## 248        chr6_mann_hap4     4      16896    4683263 3.607741e-03
## 249         chr6_mcf_hap5     4      19780    4833398 4.092359e-03
## 250         chr6_qbl_hap6     4      24449    4611984 5.301189e-03
## 251        chr6_ssto_hap7     4      26603    4928567 5.397715e-03
## 252       chr17_ctg5_hap1     4        916    1680828 5.449695e-04
## 253 chr19_gl000209_random     4       1475     159169 9.266880e-03
## 254                  chr1     5     179651  249250621 7.207645e-04
## 255                  chr2     5     166609  243199373 6.850717e-04
## 256                  chr3     5      98531  198022430 4.975749e-04
## 257                  chr4     5      66193  191154276 3.462805e-04
## 258                  chr5     5      60796  180915260 3.360468e-04
## 259                  chr6     5      96225  171115067 5.623409e-04
## 260                  chr7     5      85921  159138663 5.399128e-04
## 261                  chr8     5      55775  146364022 3.810704e-04
## 262                  chr9     5      78022  141213431 5.525112e-04
## 263                 chr10     5      61489  135534747 4.536770e-04
## 264                 chr11     5     114796  135006516 8.502997e-04
## 265                 chr12     5     152380  133851895 1.138422e-03
## 266                 chr13     5      29666  115169878 2.575847e-04
## 267                 chr14     5      59841  107349540 5.574407e-04
## 268                 chr15     5      62833  102531392 6.128172e-04
## 269                 chr16     5      61601   90354753 6.817682e-04
## 270                 chr17     5      77806   81195210 9.582585e-04
## 271                 chr18     5      17362   78077248 2.223695e-04
## 272                 chr19     5     106083   59128983 1.794095e-03
## 273                 chr20     5      64676   63025520 1.026187e-03
## 274                 chr21     5      10660   48129895 2.214840e-04
## 275                 chr22     5      44268   51304566 8.628472e-04
## 276                  chrX     5      84151  155270560 5.419637e-04
## 277                  chrY     5       8835   59373566 1.488036e-04
## 278  chr1_gl000191_random     5       1277     106433 1.199816e-02
## 279         chr6_apd_hap1     5       3283    4622290 7.102540e-04
## 280         chr6_cox_hap2     5      13422    4795371 2.798949e-03
## 281         chr6_dbb_hap3     5      12038    4610396 2.611056e-03
## 282        chr6_mann_hap4     5      10732    4683263 2.291565e-03
## 283         chr6_mcf_hap5     5      12428    4833398 2.571276e-03
## 284         chr6_qbl_hap6     5      13046    4611984 2.828718e-03
## 285        chr6_ssto_hap7     5      13717    4928567 2.783162e-03
## 286       chr17_ctg5_hap1     5       2284    1680828 1.358854e-03
## 287                  chr1     6      91005  249250621 3.651144e-04
## 288                  chr2     6     117837  243199373 4.845284e-04
## 289                  chr3     6      69473  198022430 3.508340e-04
## 290                  chr4     6      64342  191154276 3.365972e-04
## 291                  chr5     6      73054  180915260 4.038023e-04
## 292                  chr6     6      49396  171115067 2.886712e-04
## 293                  chr7     6      59477  159138663 3.737432e-04
## 294                  chr8     6      22777  146364022 1.556188e-04
## 295                  chr9     6      42789  141213431 3.030094e-04
## 296                 chr10     6      71202  135534747 5.253413e-04
## 297                 chr11     6      55365  135006516 4.100913e-04
## 298                 chr12     6      48179  133851895 3.599426e-04
## 299                 chr13     6      16843  115169878 1.462448e-04
## 300                 chr14     6      42961  107349540 4.001973e-04
## 301                 chr15     6      36030  102531392 3.514046e-04
## 302                 chr16     6      53522   90354753 5.923540e-04
## 303                 chr17     6      33819   81195210 4.165147e-04
## 304                 chr18     6      17963   78077248 2.300670e-04
## 305                 chr19     6      20575   59128983 3.479681e-04
## 306                 chr20     6      30728   63025520 4.875485e-04
## 307                 chr21     6      19247   48129895 3.998970e-04
## 308                 chr22     6      33595   51304566 6.548150e-04
## 309                  chrX     6      59968  155270560 3.862162e-04
## 310                  chrY     6       1490   59373566 2.509534e-05
## 311  chr1_gl000191_random     6         75     106433 7.046687e-04
## 312         chr6_apd_hap1     6        248    4622290 5.365306e-05
## 313         chr6_cox_hap2     6       9024    4795371 1.881815e-03
## 314         chr6_dbb_hap3     6       8724    4610396 1.892245e-03
## 315        chr6_mann_hap4     6       8724    4683263 1.862804e-03
## 316         chr6_mcf_hap5     6       5518    4833398 1.141640e-03
## 317         chr6_qbl_hap6     6       9024    4611984 1.956642e-03
## 318        chr6_ssto_hap7     6       5325    4928567 1.080436e-03
## 319       chr17_ctg5_hap1     6         87    1680828 5.176020e-05
## 320        chrUn_gl000228     6       4237     129120 3.281444e-02
## 321                  chr1     7      53307  249250621 2.138691e-04
## 322                  chr2     7      74282  243199373 3.054366e-04
## 323                  chr3     7      51171  198022430 2.584101e-04
## 324                  chr4     7      22139  191154276 1.158174e-04
## 325                  chr5     7       2914  180915260 1.610699e-05
## 326                  chr6     7      13548  171115067 7.917479e-05
## 327                  chr7     7      14243  159138663 8.950056e-05
## 328                  chr8     7      11392  146364022 7.783334e-05
## 329                  chr9     7      35136  141213431 2.488149e-04
## 330                 chr10     7      36297  135534747 2.678059e-04
## 331                 chr11     7      42394  135006516 3.140145e-04
## 332                 chr12     7      24453  133851895 1.826870e-04
## 333                 chr13     7      10962  115169878 9.518114e-05
## 334                 chr14     7      15253  107349540 1.420872e-04
## 335                 chr15     7      22034  102531392 2.149000e-04
## 336                 chr16     7      13923   90354753 1.540926e-04
## 337                 chr17     7      32873   81195210 4.048638e-04
## 338                 chr18     7       2768   78077248 3.545207e-05
## 339                 chr19     7      36684   59128983 6.204064e-04
## 340                 chr20     7      11718   63025520 1.859247e-04
## 341                 chr21     7       8288   48129895 1.722007e-04
## 342                 chr22     7      12723   51304566 2.479896e-04
## 343                  chrX     7       9157  155270560 5.897448e-05
## 344                  chrY     7        161   59373566 2.711644e-06
## 345  chr1_gl000191_random     7        621     106433 5.834657e-03
## 346         chr6_apd_hap1     7        810    4622290 1.752378e-04
## 347         chr6_cox_hap2     7        938    4795371 1.956053e-04
## 348         chr6_dbb_hap3     7        886    4610396 1.921744e-04
## 349        chr6_mann_hap4     7        938    4683263 2.002877e-04
## 350         chr6_mcf_hap5     7        938    4833398 1.940664e-04
## 351         chr6_qbl_hap6     7        938    4611984 2.033832e-04
## 352        chr6_ssto_hap7     7        650    4928567 1.318842e-04
## 353        chrUn_gl000228     7       9563     129120 7.406289e-02
## 354                  chr1     8      33862  249250621 1.358552e-04
## 355                  chr2     8      17315  243199373 7.119673e-05
## 356                  chr3     8      32249  198022430 1.628553e-04
## 357                  chr4     8      17962  191154276 9.396599e-05
## 358                  chr5     8       5842  180915260 3.229136e-05
## 359                  chr6     8       7898  171115067 4.615608e-05
## 360                  chr7     8      11184  159138663 7.027833e-05
## 361                  chr8     8      25758  146364022 1.759859e-04
## 362                  chr9     8       8642  141213431 6.119814e-05
## 363                 chr10     8      13603  135534747 1.003654e-04
## 364                 chr11     8      21606  135006516 1.600367e-04
## 365                 chr12     8      27187  133851895 2.031126e-04
## 366                 chr13     8        660  115169878 5.730665e-06
## 367                 chr14     8       6431  107349540 5.990710e-05
## 368                 chr15     8       3677  102531392 3.586219e-05
## 369                 chr16     8      13720   90354753 1.518459e-04
## 370                 chr17     8      10710   81195210 1.319043e-04
## 371                 chr18     8       8755   78077248 1.121325e-04
## 372                 chr19     8      15269   59128983 2.582321e-04
## 373                 chr20     8      11919   63025520 1.891139e-04
## 374                 chr21     8      10947   48129895 2.274470e-04
## 375                 chr22     8       5330   51304566 1.038894e-04
## 376                  chrX     8      27576  155270560 1.775997e-04
## 377                  chrY     8        322   59373566 5.423289e-06
## 378         chr6_apd_hap1     8       1488    4622290 3.219184e-04
## 379         chr6_cox_hap2     8       1488    4795371 3.102992e-04
## 380         chr6_dbb_hap3     8       1356    4610396 2.941179e-04
## 381        chr6_mann_hap4     8       1488    4683263 3.177272e-04
## 382         chr6_mcf_hap5     8       1488    4833398 3.078580e-04
## 383         chr6_qbl_hap6     8       1488    4611984 3.226377e-04
## 384        chr6_ssto_hap7     8        592    4928567 1.201160e-04
## 385       chr17_ctg5_hap1     8       5540    1680828 3.295995e-03
## 386                  chr1     9       8961  249250621 3.595177e-05
## 387                  chr2     9       4898  243199373 2.013985e-05
## 388                  chr3     9       3187  198022430 1.609414e-05
## 389                  chr4     9       9362  191154276 4.897615e-05
## 390                  chr5     9       9715  180915260 5.369917e-05
## 391                  chr6     9       6373  171115067 3.724394e-05
## 392                  chr7     9       2367  159138663 1.487382e-05
## 393                  chr8     9      10190  146364022 6.962093e-05
## 394                  chr9     9       2955  141213431 2.092577e-05
## 395                 chr10     9       9569  135534747 7.060182e-05
## 396                 chr11     9      10595  135006516 7.847769e-05
## 397                 chr12     9      15074  133851895 1.126170e-04
## 398                 chr14     9       2961  107349540 2.758279e-05
## 399                 chr15     9       4283  102531392 4.177257e-05
## 400                 chr16     9       6950   90354753 7.691903e-05
## 401                 chr17     9       9279   81195210 1.142801e-04
## 402                 chr18     9       4477   78077248 5.734065e-05
## 403                 chr19     9       4270   59128983 7.221501e-05
## 404                 chr20     9       2434   63025520 3.861928e-05
## 405                 chr22     9       3897   51304566 7.595815e-05
## 406                  chrX     9       9361  155270560 6.028831e-05
## 407                  chrY     9        923   59373566 1.554564e-05
## 408         chr6_apd_hap1     9       1526    4622290 3.301394e-04
## 409         chr6_cox_hap2     9       1530    4795371 3.190577e-04
## 410         chr6_dbb_hap3     9       1428    4610396 3.097348e-04
## 411        chr6_mann_hap4     9       1522    4683263 3.249871e-04
## 412         chr6_mcf_hap5     9       1518    4833398 3.140648e-04
## 413         chr6_qbl_hap6     9       1526    4611984 3.308771e-04
## 414        chr6_ssto_hap7     9       1522    4928567 3.088119e-04
## 415                  chr1    10      11434  249250621 4.587351e-05
## 416                  chr2    10       5372  243199373 2.208887e-05
## 417                  chr3    10        727  198022430 3.671301e-06
## 418                  chr4    10        592  191154276 3.096975e-06
## 419                  chr5    10       4025  180915260 2.224799e-05
## 420                  chr6    10      20687  171115067 1.208953e-04
## 421                  chr7    10        156  159138663 9.802772e-07
## 422                  chr8    10        568  146364022 3.880735e-06
## 423                  chr9    10       4795  141213431 3.395569e-05
## 424                 chr10    10       6872  135534747 5.070287e-05
## 425                 chr11    10       6555  135006516 4.855321e-05
## 426                 chr12    10      14113  133851895 1.054374e-04
## 427                 chr14    10       1557  107349540 1.450402e-05
## 428                 chr15    10       5450  102531392 5.315445e-05
## 429                 chr16    10         99   90354753 1.095681e-06
## 430                 chr17    10       1295   81195210 1.594922e-05
## 431                 chr18    10       9475   78077248 1.213542e-04
## 432                 chr19    10       4129   59128983 6.983039e-05
## 433                 chr20    10       1605   63025520 2.546587e-05
## 434                 chr21    10       2929   48129895 6.085615e-05
## 435                 chr22    10        523   51304566 1.019402e-05
## 436                  chrX    10       3134  155270560 2.018412e-05
## 437                  chrY    10        595   59373566 1.002129e-05
## 438         chr6_apd_hap1    10       1108    4622290 2.397080e-04
## 439         chr6_cox_hap2    10       1108    4795371 2.310562e-04
## 440         chr6_dbb_hap3    10         27    4610396 5.856330e-06
## 441        chr6_mann_hap4    10       1108    4683263 2.365872e-04
## 442         chr6_mcf_hap5    10       1108    4833398 2.292383e-04
## 443         chr6_qbl_hap6    10       1108    4611984 2.402437e-04
## 444        chr6_ssto_hap7    10       1108    4928567 2.248118e-04
## 445                  chr1    11       2253  249250621 9.039095e-06
## 446                  chr2    11       3051  243199373 1.254526e-05
## 447                  chr3    11       2620  198022430 1.323082e-05
## 448                  chr4    11       4326  191154276 2.263094e-05
## 449                  chr5    11       6357  180915260 3.513800e-05
## 450                  chr7    11        150  159138663 9.425742e-07
## 451                  chr8    11        727  146364022 4.967068e-06
## 452                  chr9    11       2047  141213431 1.449579e-05
## 453                 chr10    11      11230  135534747 8.285698e-05
## 454                 chr11    11        157  135006516 1.162907e-06
## 455                 chr12    11        168  133851895 1.255119e-06
## 456                 chr14    11       2963  107349540 2.760142e-05
## 457                 chr16    11        289   90354753 3.198504e-06
## 458                 chr17    11       3528   81195210 4.345084e-05
## 459                 chr18    11       1380   78077248 1.767480e-05
## 460                 chr19    11        276   59128983 4.667762e-06
## 461                 chr20    11       2073   63025520 3.289144e-05
## 462                 chr21    11         55   48129895 1.142741e-06
## 463                 chr22    11        174   51304566 3.391511e-06
## 464                  chrX    11      13537  155270560 8.718330e-05
## 465                  chr1    12       4582  249250621 1.838310e-05
## 466                  chr2    12       3993  243199373 1.641863e-05
## 467                  chr3    12        719  198022430 3.630902e-06
## 468                  chr4    12       4089  191154276 2.139110e-05
## 469                  chr5    12        294  180915260 1.625070e-06
## 470                  chr6    12         97  171115067 5.668700e-07
## 471                  chr7    12       1804  159138663 1.133603e-05
## 472                  chr8    12        502  146364022 3.429805e-06
## 473                  chr9    12       1783  141213431 1.262628e-05
## 474                 chr10    12      10710  135534747 7.902033e-05
## 475                 chr11    12       3218  135006516 2.383589e-05
## 476                 chr12    12        606  133851895 4.527392e-06
## 477                 chr14    12         19  107349540 1.769919e-07
## 478                 chr17    12        351   81195210 4.322915e-06
## 479                 chr18    12       8314   78077248 1.064843e-04
## 480                 chr19    12       3673   59128983 6.211844e-05
## 481                 chr20    12        241   63025520 3.823848e-06
## 482                  chrX    12       6990  155270560 4.501819e-05
## 483                  chrY    12         15   59373566 2.526377e-07
## 484                  chr1    13       7406  249250621 2.971307e-05
## 485                  chr2    13       4977  243199373 2.046469e-05
## 486                  chr3    13       5705  198022430 2.880987e-05
## 487                  chr4    13       1152  191154276 6.026546e-06
## 488                  chr5    13       2630  180915260 1.453719e-05
## 489                  chr7    13       8714  159138663 5.475728e-05
## 490                  chr9    13       9665  141213431 6.844250e-05
## 491                 chr10    13       5886  135534747 4.342798e-05
## 492                 chr11    13        199  135006516 1.474003e-06
## 493                 chr14    13         98  107349540 9.129056e-07
## 494                 chr17    13        279   81195210 3.436163e-06
## 495                 chr18    13        258   78077248 3.304420e-06
## 496                 chr19    13        868   59128983 1.467977e-05
## 497                 chr20    13       3108   63025520 4.931336e-05
## 498                 chr22    13       4284   51304566 8.350134e-05
## 499                  chrX    13        139  155270560 8.952116e-07
## 500                  chr1    14        684  249250621 2.744226e-06
## 501                  chr2    14       6384  243199373 2.625007e-05
## 502                  chr3    14        148  198022430 7.473901e-07
## 503                  chr5    14       5146  180915260 2.844426e-05
## 504                 chr10    14        592  135534747 4.367884e-06
## 505                 chr11    14        602  135006516 4.459044e-06
## 506                 chr14    14       1815  107349540 1.690738e-05
## 507                 chr17    14         65   81195210 8.005398e-07
## 508                 chr18    14       1352   78077248 1.731618e-05
## 509                 chr19    14        147   59128983 2.486090e-06
## 510                 chr20    14        303   63025520 4.807576e-06
## 511                 chr22    14       1689   51304566 3.292105e-05
## 512                  chrX    14        291  155270560 1.874148e-06
## 513                  chr1    15       1153  249250621 4.625866e-06
## 514                  chr5    15       2036  180915260 1.125389e-05
## 515                  chr8    15       9795  146364022 6.692218e-05
## 516                 chr10    15        143  135534747 1.055080e-06
## 517                 chr11    15        365  135006516 2.703573e-06
## 518                 chr12    15         60  133851895 4.482566e-07
## 519                 chr14    15        357  107349540 3.325585e-06
## 520                 chr17    15       2137   81195210 2.631929e-05
## 521                 chr18    15        309   78077248 3.957619e-06
## 522                 chr20    15        910   63025520 1.443860e-05
## 523                 chr21    15         44   48129895 9.141927e-07
## 524                  chrX    15       2060  155270560 1.326716e-05
## 525                  chr1    16       4626  249250621 1.855963e-05
## 526                  chr2    16       4313  243199373 1.773442e-05
## 527                  chr3    16        106  198022430 5.352929e-07
## 528                  chr6    16         96  171115067 5.610260e-07
## 529                 chr10    16        196  135534747 1.446124e-06
## 530                 chr11    16         22  135006516 1.629551e-07
## 531                 chr12    16          6  133851895 4.482566e-08
## 532                 chr14    16       1121  107349540 1.044252e-05
## 533                 chr17    16       8779   81195210 1.081221e-04
## 534                 chr18    16        209   78077248 2.676836e-06
## 535                 chr20    16       2337   63025520 3.708022e-05
## 536                  chrX    16       4808  155270560 3.096530e-05
## 537                  chrY    16         32   59373566 5.389604e-07
## 538                  chr1    17         50  249250621 2.006013e-07
## 539                  chr6    17        424  171115067 2.477865e-06
## 540                  chr8    17        130  146364022 8.881964e-07
## 541                 chr11    17       3545  135006516 2.625799e-05
## 542                 chr12    17        111  133851895 8.292748e-07
## 543                 chr20    17       4683   63025520 7.430323e-05
## 544                  chrX    17        999  155270560 6.433931e-06
## 545                  chr1    18        337  249250621 1.352053e-06
## 546                  chr2    18        412  243199373 1.694083e-06
## 547                  chr3    18        104  198022430 5.251930e-07
## 548                  chr5    18       2866  180915260 1.584167e-05
## 549                  chr6    18       3310  171115067 1.934371e-05
## 550                 chr10    18        226  135534747 1.667469e-06
## 551                 chr11    18       3549  135006516 2.628762e-05
## 552                 chr14    18        165  107349540 1.537035e-06
## 553                 chr20    18       2388   63025520 3.788941e-05
## 554                 chr21    18         85   48129895 1.766054e-06
## 555                  chr1    19         36  249250621 1.444329e-07
## 556                 chr11    19        253  135006516 1.873984e-06
## 557                 chr12    19        104  133851895 7.769782e-07
## 558                 chr17    19        637   81195210 7.845290e-06
## 559                  chr1    20       1080  249250621 4.332988e-06
## 560                 chr10    20       3416  135534747 2.520387e-05
## 561                 chr11    20         63  135006516 4.666441e-07
## 562                 chr14    20        223  107349540 2.077326e-06
## 563                 chr21    20       1547   48129895 3.214219e-05
## 564                  chr1    21        366  249250621 1.468402e-06
## 565                  chr6    21        353  171115067 2.062939e-06
## 566                 chr17    21         22   81195210 2.709519e-07
## 567                  chrY    21         58   59373566 9.768657e-07
## 568                  chr1    22         93  249250621 3.731184e-07
## 569                  chr5    22          2  180915260 1.105490e-08
## 570                  chr6    22        521  171115067 3.044735e-06
## 571                 chr11    22       1827  135006516 1.353268e-05
## 572                 chr12    22          9  133851895 6.723850e-08
## 573                 chr19    22        245   59128983 4.143484e-06
## 574                  chr1    23        163  249250621 6.539603e-07
## 575                 chr11    23       5344  135006516 3.958327e-05
## 576                 chr12    23      12758  133851895 9.531430e-05
## 577                 chr14    23        277  107349540 2.580356e-06
## 578                 chr17    23        126   81195210 1.551816e-06
## 579                  chr1    24         95  249250621 3.811425e-07
## 580                  chr5    24       2179  180915260 1.204431e-05
## 581                 chr12    24        432  133851895 3.227448e-06
## 582                 chr14    24         97  107349540 9.035903e-07
## 583                  chr1    25       1494  249250621 5.993967e-06
## 584                 chr17    25         75   81195210 9.236998e-07
## 585                 chr10    26       1303  135534747 9.613771e-06
## 586                 chr17    26          6   81195210 7.389598e-08
## 587                  chr1    27         70  249250621 2.808418e-07
## 588                 chr10    28        157  135534747 1.158375e-06
## 589                 chr17    28         70   81195210 8.621198e-07
## 590                  chrY    28        135   59373566 2.273739e-06
## 591                  chr1    30        980  249250621 3.931786e-06
## 592                 chr17    30        289   81195210 3.559323e-06
## 593                 chr14    31       6075  107349540 5.659083e-05
## 594                 chr17    31         88   81195210 1.083808e-06
## 595                 chr17    32        112   81195210 1.379392e-06
## 596                 chr17    33       7435   81195210 9.156944e-05
## 597                  chrY    45        535   59373566 9.010744e-06
## 598                  chrY    49        238   59373566 4.008518e-06
## 599                  chrY    63        282   59373566 4.749588e-06
## 600                  chrY    64         90   59373566 1.515826e-06
## 601                  chrY    66        171   59373566 2.880070e-06
## 602                  chrY    69         35   59373566 5.894879e-07
## 603                  chrY    70         48   59373566 8.084406e-07
## 604                  chrY    73        135   59373566 2.273739e-06
## 605                  chrY    74        263   59373566 4.429581e-06
## 606                  chrY    75       1921   59373566 3.235447e-05
## 607                  chrY    76        705   59373566 1.187397e-05
## 608                  chrY    77       2103   59373566 3.541980e-05
## 609                genome     0 3062406951 3137161264 9.761714e-01
## 610                genome     1   44120515 3137161264 1.406383e-02
## 611                genome     2   15076446 3137161264 4.805761e-03
## 612                genome     3    7294047 3137161264 2.325047e-03
## 613                genome     4    3650324 3137161264 1.163576e-03
## 614                genome     5    1926397 3137161264 6.140574e-04
## 615                genome     6    1182623 3137161264 3.769723e-04
## 616                genome     7     574102 3137161264 1.830005e-04
## 617                genome     8     353352 3137161264 1.126343e-04
## 618                genome     9     152653 3137161264 4.865960e-05
## 619                genome    10     113362 3137161264 3.613522e-05
## 620                genome    11      57361 3137161264 1.828436e-05
## 621                genome    12      52000 3137161264 1.657549e-05
## 622                genome    13      55368 3137161264 1.764908e-05
## 623                genome    14      19218 3137161264 6.125920e-06
## 624                genome    15      19369 3137161264 6.174053e-06
## 625                genome    16      26651 3137161264 8.495260e-06
## 626                genome    17       9942 3137161264 3.169107e-06
## 627                genome    18      13442 3137161264 4.284765e-06
## 628                genome    19       1030 3137161264 3.283223e-07
## 629                genome    20       6329 3137161264 2.017429e-06
## 630                genome    21        799 3137161264 2.546889e-07
## 631                genome    22       2697 3137161264 8.596944e-07
## 632                genome    23      18668 3137161264 5.950603e-06
## 633                genome    24       2803 3137161264 8.934829e-07
## 634                genome    25       1569 3137161264 5.001337e-07
## 635                genome    26       1309 3137161264 4.172562e-07
## 636                genome    27         70 3137161264 2.231317e-08
## 637                genome    28        362 3137161264 1.153909e-07
## 638                genome    30       1269 3137161264 4.045058e-07
## 639                genome    31       6163 3137161264 1.964515e-06
## 640                genome    32        112 3137161264 3.570107e-08
## 641                genome    33       7435 3137161264 2.369977e-06
## 642                genome    45        535 3137161264 1.705363e-07
## 643                genome    49        238 3137161264 7.586476e-08
## 644                genome    63        282 3137161264 8.989018e-08
## 645                genome    64         90 3137161264 2.868836e-08
## 646                genome    66        171 3137161264 5.450788e-08
## 647                genome    69         35 3137161264 1.115658e-08
## 648                genome    70         48 3137161264 1.530046e-08
## 649                genome    73        135 3137161264 4.303253e-08
## 650                genome    74        263 3137161264 8.383375e-08
## 651                genome    75       1921 3137161264 6.123370e-07
## 652                genome    76        705 3137161264 2.247255e-07
## 653                genome    77       2103 3137161264 6.703513e-07</code></pre>
<p>Although this is slightly more verbose than the <code>bedtools</code> or <code>HelloRanges</code> approach the <code>plyranges</code> code makes the actions being performed on the input <code>Ranges</code> explicit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/HelloRanges/topics/bedtools_genomecov">bedtools_genomecov</a></span>(<span class="st">"-i exons.bed -g hg19.genome"</span>)</code></pre></div>
<pre><code>## {
##     genome &lt;- import("hg19.genome")
##     gr_a &lt;- import("exons.bed", genome = genome)
##     cov &lt;- coverage(gr_a)
##     tablist &lt;- List(lapply(cov, table))
##     mcols(tablist)$len &lt;- lengths(cov, use.names = FALSE)
##     covhist &lt;- stack(tablist, "seqnames", "count", "coverage")
##     margin &lt;- aggregate(covhist, ~coverage, count = sum(NumericList(count)))[-1L]
##     margin &lt;- DataFrame(seqnames = Rle("genome"), margin, len = sum(as.numeric(lengths(cov))))
##     covhist &lt;- rbind(covhist, margin)
##     ans &lt;- within(covhist, fraction &lt;- count/len)
##     ans
## }</code></pre>
</div>
</div>
<div id="composing-pipelines" class="section level1">
<h1 class="hasAnchor">
<a href="#composing-pipelines" class="anchor"></a>Composing pipelines</h1>
<div id="yet-another-overlaps-example" class="section level2">
<h2 class="hasAnchor">
<a href="#yet-another-overlaps-example" class="anchor"></a>Yet another overlaps example</h2>
<p>Here we perform another example where we find exons with no coverage that overlap cpg islands. To compose a chain first we compute the coverage then use a filter to restrict to zero coverage ranges. Then we perfrom an inner overlap join to find which cpg islands overlap the exonic regions with zero coverage.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">overlaps &lt;-<span class="st"> </span>exons <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/compute_coverage.html">compute_coverage</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(score <span class="op">==</span><span class="st"> </span>0L) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/overlap-joins.html">join_overlap_intersect</a></span>(.,  cpg) 

overlaps</code></pre></div>
<pre><code>## GRanges object with 40913 ranges and 2 metadata columns:
##                 seqnames           ranges strand |     score        name
##                    &lt;Rle&gt;        &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;character&gt;
##       [1]           chr1 [ 28736,  29320]      * |         0    CpG:_116
##       [2]           chr1 [ 29371,  29810]      * |         0    CpG:_116
##       [3]           chr1 [437152, 438164]      * |         0     CpG:_84
##       [4]           chr1 [449274, 450544]      * |         0     CpG:_99
##       [5]           chr1 [533220, 534114]      * |         0     CpG:_94
##       ...            ...              ...    ... .       ...         ...
##   [40909] chrUn_gl000237   [10508, 10819]      * |         0     CpG:_30
##   [40910] chrUn_gl000240   [39225, 39430]      * |         0     CpG:_17
##   [40911] chrUn_gl000241   [36462, 37273]      * |         0     CpG:_71
##   [40912] chrUn_gl000242   [12843, 13099]      * |         0     CpG:_20
##   [40913] chrUn_gl000243   [30420, 30715]      * |         0     CpG:_31
##   -------
##   seqinfo: 93 sequences from hg19 genome</code></pre>
<p>We can also compute the coverage histogram of exons over cpg islands and then plot results as an ecdf.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvg_over_exons &lt;-<span class="st"> </span>exons <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/compute_coverage.html">compute_coverage</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/overlap-joins.html">join_overlap_inner</a></span>(., cpg) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">total =</span> <span class="kw">sum</span>(<span class="kw">as.numeric</span>(width))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(score) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">count =</span> <span class="kw">sum</span>(<span class="kw">as.numeric</span>(width)),
            <span class="dt">fraction =</span> count <span class="op">/</span><span class="st"> </span><span class="kw">unique</span>(total)) 

cvg_over_exons</code></pre></div>
<pre><code>## DataFrame with 28 rows and 3 columns
##         score      count     fraction
##     &lt;integer&gt;  &lt;numeric&gt;    &lt;numeric&gt;
## 1           0 3275850528 0.9961116819
## 2           1    8565943 0.0026047086
## 3           2    2429912 0.0007388810
## 4           3     915394 0.0002783505
## 5           4     373081 0.0001134455
## ...       ...        ...          ...
## 24         25        161 4.895644e-08
## 25         30         21 6.385623e-09
## 26         31        160 4.865236e-08
## 27         33        979 2.976916e-07
## 28         77       1157 3.518174e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">cumsum</span>(fraction) <span class="op">~</span><span class="st"> </span>score, <span class="dt">data =</span> cvg_over_exons, 
     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">25</span>), 
     <span class="dt">type=</span> <span class="st">"s"</span>, 
     <span class="dt">xlab =</span> <span class="st">"coverage"</span>, 
     <span class="dt">ylab =</span> <span class="st">"fraction of bp &gt; coverage"</span>)</code></pre></div>
<p><img src="comparision_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#data">Data</a></li>
      <li><a href="#reading-bed-files">Reading BED files</a></li>
      <li>
<a href="#intersections-and-overlaps">Intersections and Overlaps</a><ul class="nav nav-pills nav-stacked">
<li><a href="#keeping-the-original-features">Keeping the original features</a></li>
      <li><a href="#computing-the-amount-of-overlap">Computing the amount of overlap</a></li>
      <li><a href="#counting-the-number-of-overlaps">Counting the number of overlaps</a></li>
      <li><a href="#excluding-by-overlaps">Excluding by overlaps</a></li>
      </ul>
</li>
      <li>
<a href="#computing-genomic-coverage">Computing Genomic Coverage</a><ul class="nav nav-pills nav-stacked">
<li><a href="#coverage-vector">Coverage Vector</a></li>
      <li><a href="#coverage-histogram">Coverage histogram</a></li>
      </ul>
</li>
      <li>
<a href="#composing-pipelines">Composing pipelines</a><ul class="nav nav-pills nav-stacked">
<li><a href="#yet-another-overlaps-example">Yet another overlaps example</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Stuart Lee, Michael Lawrence, Dianne Cook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
